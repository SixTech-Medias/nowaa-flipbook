{"version":3,"file":"vue3-flipbook.mjs","sources":["../../../node_modules/.pnpm/rematrix@0.7.2/node_modules/rematrix/dist/rematrix.es.js","../src/matrix.ts","../src/utils.ts","../src/useZoom.ts","../src/useImageLoad.ts","../../../node_modules/.pnpm/consola@3.2.3/node_modules/consola/dist/core.mjs","../../../node_modules/.pnpm/consola@3.2.3/node_modules/consola/dist/browser.mjs","../src/flipProps.ts","../src/Flipbook.vue","../src/index.ts"],"sourcesContent":["/*! @license Rematrix v0.7.2\n\n\tCopyright 2021 Julian Lloyd.\n\n\tPermission is hereby granted, free of charge, to any person obtaining a copy\n\tof this software and associated documentation files (the \"Software\"), to deal\n\tin the Software without restriction, including without limitation the rights\n\tto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\tcopies of the Software, and to permit persons to whom the Software is\n\tfurnished to do so, subject to the following conditions:\n\n\tThe above copyright notice and this permission notice shall be included in\n\tall copies or substantial portions of the Software.\n\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\tIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\tAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\tLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\tOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\tTHE SOFTWARE.\n*/\nfunction format(source) {\n  if (source && source.constructor === Array) {\n    var values = source\n      .filter(function (value) { return typeof value === 'number'; })\n      .filter(function (value) { return !isNaN(value); });\n\n    if (source.length === 6 && values.length === 6) {\n      var matrix = identity();\n      matrix[0] = values[0];\n      matrix[1] = values[1];\n      matrix[4] = values[2];\n      matrix[5] = values[3];\n      matrix[12] = values[4];\n      matrix[13] = values[5];\n      return matrix\n    } else if (source.length === 16 && values.length === 16) {\n      return source\n    }\n  }\n  throw new TypeError('Expected a `number[]` with length 6 or 16.')\n}\n\nfunction fromString(source) {\n  if (typeof source === 'string') {\n    var match = source.match(/matrix(3d)?\\(([^)]+)\\)/);\n    if (match) {\n      var raw = match[2].split(',').map(parseFloat);\n      return format(raw)\n    }\n    if (source === 'none' || source === '') {\n      return identity()\n    }\n  }\n  throw new TypeError('Expected a string containing `matrix()` or `matrix3d()')\n}\n\nfunction identity() {\n  var matrix = [];\n  for (var i = 0; i < 16; i++) {\n    i % 5 == 0 ? matrix.push(1) : matrix.push(0);\n  }\n  return matrix\n}\n\nfunction inverse(source) {\n  var m = format(source);\n\n  var s0 = m[0] * m[5] - m[4] * m[1];\n  var s1 = m[0] * m[6] - m[4] * m[2];\n  var s2 = m[0] * m[7] - m[4] * m[3];\n  var s3 = m[1] * m[6] - m[5] * m[2];\n  var s4 = m[1] * m[7] - m[5] * m[3];\n  var s5 = m[2] * m[7] - m[6] * m[3];\n\n  var c5 = m[10] * m[15] - m[14] * m[11];\n  var c4 = m[9] * m[15] - m[13] * m[11];\n  var c3 = m[9] * m[14] - m[13] * m[10];\n  var c2 = m[8] * m[15] - m[12] * m[11];\n  var c1 = m[8] * m[14] - m[12] * m[10];\n  var c0 = m[8] * m[13] - m[12] * m[9];\n\n  var determinant = 1 / (s0 * c5 - s1 * c4 + s2 * c3 + s3 * c2 - s4 * c1 + s5 * c0);\n\n  if (isNaN(determinant) || determinant === Infinity) {\n    throw new Error('Inverse determinant attempted to divide by zero.')\n  }\n\n  return [\n    (m[5] * c5 - m[6] * c4 + m[7] * c3) * determinant,\n    (-m[1] * c5 + m[2] * c4 - m[3] * c3) * determinant,\n    (m[13] * s5 - m[14] * s4 + m[15] * s3) * determinant,\n    (-m[9] * s5 + m[10] * s4 - m[11] * s3) * determinant,\n\n    (-m[4] * c5 + m[6] * c2 - m[7] * c1) * determinant,\n    (m[0] * c5 - m[2] * c2 + m[3] * c1) * determinant,\n    (-m[12] * s5 + m[14] * s2 - m[15] * s1) * determinant,\n    (m[8] * s5 - m[10] * s2 + m[11] * s1) * determinant,\n\n    (m[4] * c4 - m[5] * c2 + m[7] * c0) * determinant,\n    (-m[0] * c4 + m[1] * c2 - m[3] * c0) * determinant,\n    (m[12] * s4 - m[13] * s2 + m[15] * s0) * determinant,\n    (-m[8] * s4 + m[9] * s2 - m[11] * s0) * determinant,\n\n    (-m[4] * c3 + m[5] * c1 - m[6] * c0) * determinant,\n    (m[0] * c3 - m[1] * c1 + m[2] * c0) * determinant,\n    (-m[12] * s3 + m[13] * s1 - m[14] * s0) * determinant,\n    (m[8] * s3 - m[9] * s1 + m[10] * s0) * determinant ]\n}\n\nfunction multiply(matrixA, matrixB) {\n  var fma = format(matrixA);\n  var fmb = format(matrixB);\n  var product = [];\n\n  for (var i = 0; i < 4; i++) {\n    var row = [fma[i], fma[i + 4], fma[i + 8], fma[i + 12]];\n    for (var j = 0; j < 4; j++) {\n      var k = j * 4;\n      var col = [fmb[k], fmb[k + 1], fmb[k + 2], fmb[k + 3]];\n      var result = row[0] * col[0] + row[1] * col[1] + row[2] * col[2] + row[3] * col[3];\n\n      product[i + k] = result;\n    }\n  }\n\n  return product\n}\n\nfunction perspective(distance) {\n  var matrix = identity();\n  matrix[11] = -1 / distance;\n  return matrix\n}\n\nfunction rotate(angle) {\n  return rotateZ(angle)\n}\n\nfunction rotateX(angle) {\n  var theta = (Math.PI / 180) * angle;\n  var matrix = identity();\n\n  matrix[5] = matrix[10] = Math.cos(theta);\n  matrix[6] = matrix[9] = Math.sin(theta);\n  matrix[9] *= -1;\n\n  return matrix\n}\n\nfunction rotateY(angle) {\n  var theta = (Math.PI / 180) * angle;\n  var matrix = identity();\n\n  matrix[0] = matrix[10] = Math.cos(theta);\n  matrix[2] = matrix[8] = Math.sin(theta);\n  matrix[2] *= -1;\n\n  return matrix\n}\n\nfunction rotateZ(angle) {\n  var theta = (Math.PI / 180) * angle;\n  var matrix = identity();\n\n  matrix[0] = matrix[5] = Math.cos(theta);\n  matrix[1] = matrix[4] = Math.sin(theta);\n  matrix[4] *= -1;\n\n  return matrix\n}\n\nfunction scale(scalar, scalarY) {\n  var matrix = identity();\n\n  matrix[0] = scalar;\n  matrix[5] = typeof scalarY === 'number' ? scalarY : scalar;\n\n  return matrix\n}\n\nfunction scaleX(scalar) {\n  var matrix = identity();\n  matrix[0] = scalar;\n  return matrix\n}\n\nfunction scaleY(scalar) {\n  var matrix = identity();\n  matrix[5] = scalar;\n  return matrix\n}\n\nfunction scaleZ(scalar) {\n  var matrix = identity();\n  matrix[10] = scalar;\n  return matrix\n}\n\nfunction skew(angleX, angleY) {\n  var thetaX = (Math.PI / 180) * angleX;\n  var matrix = identity();\n\n  matrix[4] = Math.tan(thetaX);\n\n  if (angleY) {\n    var thetaY = (Math.PI / 180) * angleY;\n    matrix[1] = Math.tan(thetaY);\n  }\n\n  return matrix\n}\n\nfunction skewX(angle) {\n  var theta = (Math.PI / 180) * angle;\n  var matrix = identity();\n\n  matrix[4] = Math.tan(theta);\n\n  return matrix\n}\n\nfunction skewY(angle) {\n  var theta = (Math.PI / 180) * angle;\n  var matrix = identity();\n\n  matrix[1] = Math.tan(theta);\n\n  return matrix\n}\n\nfunction toString(source) {\n  return (\"matrix3d(\" + (format(source).join(', ')) + \")\")\n}\n\nfunction translate(distanceX, distanceY) {\n  var matrix = identity();\n  matrix[12] = distanceX;\n\n  if (distanceY) {\n    matrix[13] = distanceY;\n  }\n\n  return matrix\n}\n\nfunction translate3d(distanceX, distanceY, distanceZ) {\n  var matrix = identity();\n  if (distanceX !== undefined && distanceY !== undefined && distanceZ !== undefined) {\n    matrix[12] = distanceX;\n    matrix[13] = distanceY;\n    matrix[14] = distanceZ;\n  }\n  return matrix\n}\n\nfunction translateX(distance) {\n  var matrix = identity();\n  matrix[12] = distance;\n  return matrix\n}\n\nfunction translateY(distance) {\n  var matrix = identity();\n  matrix[13] = distance;\n  return matrix\n}\n\nfunction translateZ(distance) {\n  var matrix = identity();\n  matrix[14] = distance;\n  return matrix\n}\n\nexport { format, fromString, identity, inverse, multiply, perspective, rotate, rotateX, rotateY, rotateZ, scale, scaleX, scaleY, scaleZ, skew, skewX, skewY, toString, translate, translate3d, translateX, translateY, translateZ };\n","import {\n  identity,\n  multiply,\n  perspective,\n  translate,\n  translate3d,\n  rotateY,\n  toString\n} from 'rematrix'\n\nimport type { Matrix3D } from 'rematrix'\n\nexport default class Matrix {\n  private m: Matrix3D\n\n  constructor(arg?: Matrix3D) {\n    if (arg) {\n      this.m = [...arg]\n    } else {\n      this.m = identity()\n    }\n  }\n\n  public clone(): Matrix {\n    return new Matrix(this.m)\n  }\n\n  public multiply(m: Matrix3D): void {\n    this.m = multiply(this.m, m)\n  }\n\n  public perspective(d: number): void {\n    this.multiply(perspective(d))\n  }\n\n  public transformX(x: number): number {\n    return (x * this.m[0] + this.m[12]) / (x * this.m[3] + this.m[15])\n  }\n\n  public translate(x: number, y?: number): void {\n    this.multiply(translate(x, y))\n  }\n\n  public translate3d(x: number, y: number, z: number): void {\n    this.multiply(translate3d(x, y, z))\n  }\n\n  public rotateY(deg: number): void {\n    this.multiply(rotateY(deg))\n  }\n\n  public toString(): string {\n    return toString(this.m)\n  }\n}\n","import Matrix from './matrix'\n// 计算页面旋转角度\nexport const calculatePageRotation = (\n  progress: number,\n  direction: string,\n  face: string\n): number => {\n  let pageRotation: number = 0\n  if (progress > 0.5) {\n    pageRotation = -(progress - 0.5) * 2 * 180\n  }\n  if (direction === 'left') {\n    pageRotation = -pageRotation\n  }\n  if (face === 'back') {\n    pageRotation += 180\n  }\n  return pageRotation\n}\n\nconst easeIn = (x: number): number => Math.pow(x, 2)\nconst easeOut = (x: number): number => 1 - easeIn(1 - x)\nexport const easeInOut = (x: number): number => {\n  if (x < 0.5) {\n    return easeIn(x * 2) / 2\n  } else {\n    return 0.5 + easeOut((x - 0.5) * 2) / 2\n  }\n}\n\n// // 计算页面X坐标和原点位置\nexport const calculatePageXAndOrigin = (\n  face: string,\n  direction: string,\n  xMargin: number,\n  displayedPages: number,\n  forwardDirection: string,\n  pageWidth: number,\n  viewWidth: number\n) => {\n  let pageX = xMargin\n  let originRight = false\n  if (displayedPages === 1) {\n    if (forwardDirection === 'right') {\n      if (face === 'back') {\n        originRight = true\n        pageX = xMargin - pageWidth\n      }\n    } else {\n      if (direction === 'left') {\n        if (face === 'back') {\n          pageX = pageWidth - xMargin\n        } else {\n          originRight = true\n        }\n      } else {\n        if (face === 'front') {\n          pageX = pageWidth - xMargin\n        } else {\n          originRight = true\n        }\n      }\n    }\n  } else {\n    if (direction === 'left') {\n      if (face === 'back') {\n        pageX = viewWidth / 2\n      } else {\n        originRight = true\n      }\n    } else {\n      if (face === 'front') {\n        pageX = viewWidth / 2\n      } else {\n        originRight = true\n      }\n    }\n  }\n  return {\n    pageX,\n    originRight\n  }\n}\n\n// 计算页面矩阵\nexport const calculatePageMatrix = (\n  pageX: number,\n  originRight: boolean,\n  pageRotation: number,\n  viewWidth: number,\n  perspective: number,\n  yMargin: number,\n  pageWidth: number\n) => {\n  const pageMatrix = new Matrix()\n  pageMatrix.translate(viewWidth / 2)\n  pageMatrix.perspective(perspective)\n  pageMatrix.translate(-viewWidth / 2)\n  pageMatrix.translate(pageX, yMargin)\n\n  if (pageRotation) {\n    if (originRight) {\n      pageMatrix.translate(pageWidth)\n    }\n    pageMatrix.rotateY(pageRotation)\n    if (originRight) {\n      pageMatrix.translate(-pageWidth)\n    }\n  }\n\n  return pageMatrix\n}\n\nexport const calculateThetaAndRadius = (progress: number, pageWidth: number) => {\n  let theta\n  if (progress < 0.5) theta = progress * 2 * Math.PI\n  else theta = (1 - (progress - 0.5) * 2) * Math.PI\n  if (theta == 0) theta = 1e-9\n\n  const radius = pageWidth / theta\n\n  return {\n    theta,\n    radius\n  }\n}\n\nexport const calculateRotate = (theta: number, dRadian: number, originRight: boolean) => {\n  return originRight\n    ? (-theta / Math.PI) * 180 + (dRadian / 2 / Math.PI) * 180\n    : (dRadian / 2 / Math.PI) * 180\n}\n\nexport const computeLighting = (\n  rot: number,\n  dRotate: number,\n  ambient: number,\n  gloss: number\n): string => {\n  const gradients = []\n  const lightingPoints = [-0.5, -0.25, 0, 0.25, 0.5]\n  if (ambient < 1) {\n    const blackness = 1 - ambient\n    const diffuse = lightingPoints.map(\n      (d) => (1 - Math.cos(((rot - dRotate * d) / 180) * Math.PI)) * blackness\n    )\n    gradients.push(\n      `linear-gradient(to right, rgba(0, 0, 0, ${diffuse[0]}), rgba(0, 0, 0, ${diffuse[1]}) 25%, rgba(0, 0, 0, ${diffuse[2]}) 50%, rgba(0, 0, 0, ${diffuse[3]}) 75%, rgba(0, 0, 0, ${diffuse[4]}))`\n    )\n  }\n\n  if (gloss > 0) {\n    const DEG = 30\n    const POW = 200\n    const specular = lightingPoints.map((d) =>\n      Math.max(\n        Math.cos(((rot + DEG - dRotate * d) / 180) * Math.PI) ** POW,\n        Math.cos(((rot - DEG - dRotate * d) / 180) * Math.PI) ** POW\n      )\n    )\n    gradients.push(\n      `linear-gradient(to right, rgba(255, 255, 255, ${specular[0] * gloss}), rgba(255, 255, 255, ${\n        specular[1] * gloss\n      }) 25%, rgba(255, 255, 255, ${specular[2] * gloss}) 50%, rgba(255, 255, 255, ${\n        specular[3] * gloss\n      }) 75%, rgba(255, 255, 255, ${specular[4] * gloss}))`\n    )\n  }\n\n  return gradients.join(',')\n}\n\nexport const calculateXAndZ = (rad: number, radius: number, originRight: boolean, face: string,pageWidth:number) => {\n  let x = Math.sin(rad) * radius\n  if (originRight) {\n    x = pageWidth - x\n  }\n  let z = (1 - Math.cos(rad)) * radius\n  if (face === 'back') {\n    z = -z\n  }\n\n  return { x, z }\n}\n","import { ref, computed, Ref, getCurrentInstance } from 'vue'\nimport { easeInOut } from './utils.js'\nimport type { FlipProps } from './flipProps.ts'\n\nexport type TouchPoint = {\n  pageX: number\n  pageY: number\n}\nexport interface UseZoom {\n  zoom: Ref<number>\n  zooming: Ref<boolean>\n  canZoomIn: Ref<boolean>\n  canZoomOut: Ref<boolean>\n  zoomIn: (ev: TouchPoint) => void\n  zoomOut: (ev: TouchPoint) => void\n  zoomAt: (ev: TouchPoint) => void\n  onWheel: (ev: WheelEvent, hasTouchEvents: boolean) => void\n  scrollLeft: Ref<number>\n  scrollTop: Ref<number>\n}\n\nexport default function useZoom(\n  refViewport: Ref<HTMLDivElement | undefined>,\n  preloadImages: (arg0: boolean) => void | undefined\n): UseZoom {\n  const currentInstance = getCurrentInstance()\n  if (!currentInstance) {\n    throw new Error('useDrawer() can only be used inside setup() or functional components!')\n  }\n  const props = currentInstance.props as FlipProps\n  const zoom = ref<number>(1)\n  let zoomIndex = 0\n  const zooming = ref<boolean>(false)\n  const scrollLeft = ref<number>(0)\n  const scrollTop = ref<number>(0)\n  const zoomIn = (zoomAt: TouchPoint): void => {\n    if (!canZoomIn.value) return\n    zoomIndex += 1\n    if (props.zooms) {\n      zoomTo(props.zooms[zoomIndex], zoomAt)\n    }\n  }\n\n  const zoomOut = (zoomAt: TouchPoint) => {\n    if (!canZoomOut.value) return\n    zoomIndex -= 1\n    if (props.zooms) {\n      zoomTo(props.zooms[zoomIndex], zoomAt)\n    }\n  }\n\n  const zoomTo = (pzoom: number, zoomAt: TouchPoint) => {\n\n    const viewport = refViewport?.value\n    if (viewport) {\n      let fixedX, fixedY\n      if (zoomAt) {\n        const rect = viewport.getBoundingClientRect()\n        fixedX = zoomAt.pageX - rect.left\n        fixedY = zoomAt.pageY - rect.top\n      } else {\n        fixedX = viewport.clientWidth / 2\n        fixedY = viewport.clientHeight / 2\n      }\n      const start = zoom.value\n      const end = pzoom\n      const startX = viewport.scrollLeft\n      const startY = viewport.scrollTop\n      const containerFixedX = fixedX + startX\n      const containerFixedY = fixedY + startY\n      const endX = (containerFixedX / start) * end - fixedX\n      const endY = (containerFixedY / start) * end - fixedY\n      const t0 = Date.now()\n      zooming.value = true\n      currentInstance?.emit('zoom-start', pzoom)\n      const animate = () => {\n        requestAnimationFrame(() => {\n          const t = Date.now() - t0\n          let ratio = t / props.zoomDuration!\n          ratio = ratio > 1 ? 1 : ratio\n          ratio = easeInOut(ratio)\n          zoom.value = start + (end - start) * ratio\n          scrollLeft.value = startX + (endX - startX) * ratio\n          scrollTop.value = startY + (endY - startY) * ratio\n          if (t < props.zoomDuration!) {\n            animate()\n          } else {\n            currentInstance?.emit('zoom-end', pzoom)\n            zooming.value = false\n            zoom.value = pzoom\n            scrollLeft.value = endX\n            scrollTop.value = endY\n          }\n        })\n      }\n      animate()\n      if (end > 1) {\n        preloadImages(true)\n      }\n    }\n  }\n\n  const zoomAt = (zoomAtv: TouchPoint) => {\n    zoomIndex = (zoomIndex + 1) % props.zooms!.length\n    zoomTo(props.zooms![zoomIndex], zoomAtv)\n  }\n  const canZoomIn = computed(() => !zooming.value && zoomIndex < props.zooms!.length - 1)\n\n  const canZoomOut = computed(() => !zooming.value && zoomIndex > 0)\n\n  const onWheel = (ev: WheelEvent, hasTouchEvents: boolean): void => {\n    if (props.wheel === 'scroll' && zoom.value > 1 && !hasTouchEvents && refViewport.value) {\n      scrollLeft.value = refViewport.value.scrollLeft + ev.deltaX\n      scrollTop.value = refViewport.value.scrollTop + ev.deltaY\n      if (ev.cancelable) {\n        ev.preventDefault()\n      }\n    }\n\n    if (props.wheel === 'zoom') {\n      if (ev.deltaY >= 100) {\n        zoomOut(ev)\n        ev.preventDefault()\n      } else if (ev.deltaY <= -100) {\n        zoomIn(ev)\n        ev.preventDefault()\n      }\n    }\n  }\n\n  return {\n    zoom,\n    zooming,\n    canZoomIn,\n    canZoomOut,\n    zoomIn,\n    zoomOut,\n    zoomAt,\n    onWheel,\n    scrollLeft,\n    scrollTop\n  }\n}\n","import { ref, Ref, getCurrentInstance } from 'vue'\nimport type { FlipProps } from './flipProps.ts'\n\ninterface UseImageLoad {\n  imageWidth: Ref<number | null>\n  imageHeight: Ref<number | null>\n  pageUrl: (page: number, hiRes?: boolean) => string\n  loadImage: (url: string) => string\n  pageUrlLoading: (page: number, hiRes: boolean) => string | undefined\n  // onImageLoad: (trigger: number, cb: () => void) => void\n  didLoadImage: (ev: Event) => void\n}\nexport default function useImageLoad(\n  preloadImages: () => void, // Add the missing type annotation here\n  zoom: Ref<number>,\n  zooming: Ref<boolean>\n): UseImageLoad {\n  const loadedImages = ref<Record<string, boolean>>({})\n  const nImageLoad = ref<number>(0)\n  const nImageLoadTrigger = ref<number>(0)\n  const imageLoadCallback = ref<() => void | null>()\n  const imageWidth = ref<number | null>(null)\n  const imageHeight = ref<number | null>(null)\n  const currentInstance = getCurrentInstance()\n  if (!currentInstance) {\n    throw new Error('useDrawer() can only be used inside setup() or functional components!')\n  }\n  const props = currentInstance.props as FlipProps\n  const pageUrl = (page: number, hiRes = false): string => {\n    if (page < 1) return ''\n    if (hiRes && zoom.value > 1 && !zooming.value) {\n      return (page < props.pagesHiRes!.length ? props.pagesHiRes?.[page] : '') || ''\n    } else {\n      return (page < props.pages!.length ? props.pages?.[page] : '') || ''\n    }\n  }\n\n  const loadImage = (url: string): string => {\n    if (imageWidth.value === null) {\n      return url\n    } else {\n      if (loadedImages.value[url]) {\n        return url\n      } else {\n        const img = new Image()\n        img.onload = () => {\n          loadedImages.value[url] = true\n        }\n        img.src = url\n        return props.loadingImage || ''\n      }\n    }\n  }\n\n  const pageUrlLoading = (page: number, hiRes = false): string | undefined => {\n    const url = pageUrl(page, hiRes)\n    if (hiRes && zoom.value > 1 && !zooming.value) {\n      return url\n    }\n    return url && loadImage(url)\n  }\n\n  // const onImageLoad = (trigger: number, cb: Function): void => {\n  //   nImageLoad.value = 0\n  //   nImageLoadTrigger.value = trigger\n  //   imageLoadCallback.value = cb\n  // }\n\n  const didLoadImage = (ev: Event) => {\n    if (imageWidth.value === null) {\n      imageWidth.value = (ev.target as HTMLImageElement).naturalWidth\n      imageHeight.value = (ev.target as HTMLImageElement).naturalHeight\n      preloadImages()\n    }\n    if (!imageLoadCallback.value) return\n    if (++nImageLoad.value >= nImageLoadTrigger.value) {\n      imageLoadCallback.value!()\n    }\n    imageLoadCallback.value = undefined\n  }\n\n  return {\n    imageWidth,\n    imageHeight,\n    pageUrl,\n    loadImage,\n    pageUrlLoading,\n    // onImageLoad,\n    didLoadImage\n  }\n}\n","const LogLevels = {\n  silent: Number.NEGATIVE_INFINITY,\n  fatal: 0,\n  error: 0,\n  warn: 1,\n  log: 2,\n  info: 3,\n  success: 3,\n  fail: 3,\n  ready: 3,\n  start: 3,\n  box: 3,\n  debug: 4,\n  trace: 5,\n  verbose: Number.POSITIVE_INFINITY\n};\nconst LogTypes = {\n  // Silent\n  silent: {\n    level: -1\n  },\n  // Level 0\n  fatal: {\n    level: LogLevels.fatal\n  },\n  error: {\n    level: LogLevels.error\n  },\n  // Level 1\n  warn: {\n    level: LogLevels.warn\n  },\n  // Level 2\n  log: {\n    level: LogLevels.log\n  },\n  // Level 3\n  info: {\n    level: LogLevels.info\n  },\n  success: {\n    level: LogLevels.success\n  },\n  fail: {\n    level: LogLevels.fail\n  },\n  ready: {\n    level: LogLevels.info\n  },\n  start: {\n    level: LogLevels.info\n  },\n  box: {\n    level: LogLevels.info\n  },\n  // Level 4\n  debug: {\n    level: LogLevels.debug\n  },\n  // Level 5\n  trace: {\n    level: LogLevels.trace\n  },\n  // Verbose\n  verbose: {\n    level: LogLevels.verbose\n  }\n};\n\nfunction isObject(value) {\n  return value !== null && typeof value === \"object\";\n}\nfunction _defu(baseObject, defaults, namespace = \".\", merger) {\n  if (!isObject(defaults)) {\n    return _defu(baseObject, {}, namespace, merger);\n  }\n  const object = Object.assign({}, defaults);\n  for (const key in baseObject) {\n    if (key === \"__proto__\" || key === \"constructor\") {\n      continue;\n    }\n    const value = baseObject[key];\n    if (value === null || value === void 0) {\n      continue;\n    }\n    if (merger && merger(object, key, value, namespace)) {\n      continue;\n    }\n    if (Array.isArray(value) && Array.isArray(object[key])) {\n      object[key] = [...value, ...object[key]];\n    } else if (isObject(value) && isObject(object[key])) {\n      object[key] = _defu(\n        value,\n        object[key],\n        (namespace ? `${namespace}.` : \"\") + key.toString(),\n        merger\n      );\n    } else {\n      object[key] = value;\n    }\n  }\n  return object;\n}\nfunction createDefu(merger) {\n  return (...arguments_) => (\n    // eslint-disable-next-line unicorn/no-array-reduce\n    arguments_.reduce((p, c) => _defu(p, c, \"\", merger), {})\n  );\n}\nconst defu = createDefu();\n\nfunction isPlainObject(obj) {\n  return Object.prototype.toString.call(obj) === \"[object Object]\";\n}\nfunction isLogObj(arg) {\n  if (!isPlainObject(arg)) {\n    return false;\n  }\n  if (!arg.message && !arg.args) {\n    return false;\n  }\n  if (arg.stack) {\n    return false;\n  }\n  return true;\n}\n\nlet paused = false;\nconst queue = [];\nclass Consola {\n  constructor(options = {}) {\n    const types = options.types || LogTypes;\n    this.options = defu(\n      {\n        ...options,\n        defaults: { ...options.defaults },\n        level: _normalizeLogLevel(options.level, types),\n        reporters: [...options.reporters || []]\n      },\n      {\n        types: LogTypes,\n        throttle: 1e3,\n        throttleMin: 5,\n        formatOptions: {\n          date: true,\n          colors: false,\n          compact: true\n        }\n      }\n    );\n    for (const type in types) {\n      const defaults = {\n        type,\n        ...this.options.defaults,\n        ...types[type]\n      };\n      this[type] = this._wrapLogFn(defaults);\n      this[type].raw = this._wrapLogFn(\n        defaults,\n        true\n      );\n    }\n    if (this.options.mockFn) {\n      this.mockTypes();\n    }\n    this._lastLog = {};\n  }\n  get level() {\n    return this.options.level;\n  }\n  set level(level) {\n    this.options.level = _normalizeLogLevel(\n      level,\n      this.options.types,\n      this.options.level\n    );\n  }\n  prompt(message, opts) {\n    if (!this.options.prompt) {\n      throw new Error(\"prompt is not supported!\");\n    }\n    return this.options.prompt(message, opts);\n  }\n  create(options) {\n    const instance = new Consola({\n      ...this.options,\n      ...options\n    });\n    if (this._mockFn) {\n      instance.mockTypes(this._mockFn);\n    }\n    return instance;\n  }\n  withDefaults(defaults) {\n    return this.create({\n      ...this.options,\n      defaults: {\n        ...this.options.defaults,\n        ...defaults\n      }\n    });\n  }\n  withTag(tag) {\n    return this.withDefaults({\n      tag: this.options.defaults.tag ? this.options.defaults.tag + \":\" + tag : tag\n    });\n  }\n  addReporter(reporter) {\n    this.options.reporters.push(reporter);\n    return this;\n  }\n  removeReporter(reporter) {\n    if (reporter) {\n      const i = this.options.reporters.indexOf(reporter);\n      if (i >= 0) {\n        return this.options.reporters.splice(i, 1);\n      }\n    } else {\n      this.options.reporters.splice(0);\n    }\n    return this;\n  }\n  setReporters(reporters) {\n    this.options.reporters = Array.isArray(reporters) ? reporters : [reporters];\n    return this;\n  }\n  wrapAll() {\n    this.wrapConsole();\n    this.wrapStd();\n  }\n  restoreAll() {\n    this.restoreConsole();\n    this.restoreStd();\n  }\n  wrapConsole() {\n    for (const type in this.options.types) {\n      if (!console[\"__\" + type]) {\n        console[\"__\" + type] = console[type];\n      }\n      console[type] = this[type].raw;\n    }\n  }\n  restoreConsole() {\n    for (const type in this.options.types) {\n      if (console[\"__\" + type]) {\n        console[type] = console[\"__\" + type];\n        delete console[\"__\" + type];\n      }\n    }\n  }\n  wrapStd() {\n    this._wrapStream(this.options.stdout, \"log\");\n    this._wrapStream(this.options.stderr, \"log\");\n  }\n  _wrapStream(stream, type) {\n    if (!stream) {\n      return;\n    }\n    if (!stream.__write) {\n      stream.__write = stream.write;\n    }\n    stream.write = (data) => {\n      this[type].raw(String(data).trim());\n    };\n  }\n  restoreStd() {\n    this._restoreStream(this.options.stdout);\n    this._restoreStream(this.options.stderr);\n  }\n  _restoreStream(stream) {\n    if (!stream) {\n      return;\n    }\n    if (stream.__write) {\n      stream.write = stream.__write;\n      delete stream.__write;\n    }\n  }\n  pauseLogs() {\n    paused = true;\n  }\n  resumeLogs() {\n    paused = false;\n    const _queue = queue.splice(0);\n    for (const item of _queue) {\n      item[0]._logFn(item[1], item[2]);\n    }\n  }\n  mockTypes(mockFn) {\n    const _mockFn = mockFn || this.options.mockFn;\n    this._mockFn = _mockFn;\n    if (typeof _mockFn !== \"function\") {\n      return;\n    }\n    for (const type in this.options.types) {\n      this[type] = _mockFn(type, this.options.types[type]) || this[type];\n      this[type].raw = this[type];\n    }\n  }\n  _wrapLogFn(defaults, isRaw) {\n    return (...args) => {\n      if (paused) {\n        queue.push([this, defaults, args, isRaw]);\n        return;\n      }\n      return this._logFn(defaults, args, isRaw);\n    };\n  }\n  _logFn(defaults, args, isRaw) {\n    if ((defaults.level || 0) > this.level) {\n      return false;\n    }\n    const logObj = {\n      date: /* @__PURE__ */ new Date(),\n      args: [],\n      ...defaults,\n      level: _normalizeLogLevel(defaults.level, this.options.types)\n    };\n    if (!isRaw && args.length === 1 && isLogObj(args[0])) {\n      Object.assign(logObj, args[0]);\n    } else {\n      logObj.args = [...args];\n    }\n    if (logObj.message) {\n      logObj.args.unshift(logObj.message);\n      delete logObj.message;\n    }\n    if (logObj.additional) {\n      if (!Array.isArray(logObj.additional)) {\n        logObj.additional = logObj.additional.split(\"\\n\");\n      }\n      logObj.args.push(\"\\n\" + logObj.additional.join(\"\\n\"));\n      delete logObj.additional;\n    }\n    logObj.type = typeof logObj.type === \"string\" ? logObj.type.toLowerCase() : \"log\";\n    logObj.tag = typeof logObj.tag === \"string\" ? logObj.tag : \"\";\n    const resolveLog = (newLog = false) => {\n      const repeated = (this._lastLog.count || 0) - this.options.throttleMin;\n      if (this._lastLog.object && repeated > 0) {\n        const args2 = [...this._lastLog.object.args];\n        if (repeated > 1) {\n          args2.push(`(repeated ${repeated} times)`);\n        }\n        this._log({ ...this._lastLog.object, args: args2 });\n        this._lastLog.count = 1;\n      }\n      if (newLog) {\n        this._lastLog.object = logObj;\n        this._log(logObj);\n      }\n    };\n    clearTimeout(this._lastLog.timeout);\n    const diffTime = this._lastLog.time && logObj.date ? logObj.date.getTime() - this._lastLog.time.getTime() : 0;\n    this._lastLog.time = logObj.date;\n    if (diffTime < this.options.throttle) {\n      try {\n        const serializedLog = JSON.stringify([\n          logObj.type,\n          logObj.tag,\n          logObj.args\n        ]);\n        const isSameLog = this._lastLog.serialized === serializedLog;\n        this._lastLog.serialized = serializedLog;\n        if (isSameLog) {\n          this._lastLog.count = (this._lastLog.count || 0) + 1;\n          if (this._lastLog.count > this.options.throttleMin) {\n            this._lastLog.timeout = setTimeout(\n              resolveLog,\n              this.options.throttle\n            );\n            return;\n          }\n        }\n      } catch {\n      }\n    }\n    resolveLog(true);\n  }\n  _log(logObj) {\n    for (const reporter of this.options.reporters) {\n      reporter.log(logObj, {\n        options: this.options\n      });\n    }\n  }\n}\nfunction _normalizeLogLevel(input, types = {}, defaultLevel = 3) {\n  if (input === void 0) {\n    return defaultLevel;\n  }\n  if (typeof input === \"number\") {\n    return input;\n  }\n  if (types[input] && types[input].level !== void 0) {\n    return types[input].level;\n  }\n  return defaultLevel;\n}\nConsola.prototype.add = Consola.prototype.addReporter;\nConsola.prototype.remove = Consola.prototype.removeReporter;\nConsola.prototype.clear = Consola.prototype.removeReporter;\nConsola.prototype.withScope = Consola.prototype.withTag;\nConsola.prototype.mock = Consola.prototype.mockTypes;\nConsola.prototype.pause = Consola.prototype.pauseLogs;\nConsola.prototype.resume = Consola.prototype.resumeLogs;\nfunction createConsola(options = {}) {\n  return new Consola(options);\n}\n\nexport { Consola, LogLevels, LogTypes, createConsola };\n","import { createConsola as createConsola$1 } from './core.mjs';\nexport { Consola, LogLevels, LogTypes } from './core.mjs';\n\nclass BrowserReporter {\n  constructor(options) {\n    this.options = { ...options };\n    this.defaultColor = \"#7f8c8d\";\n    this.levelColorMap = {\n      0: \"#c0392b\",\n      // Red\n      1: \"#f39c12\",\n      // Yellow\n      3: \"#00BCD4\"\n      // Cyan\n    };\n    this.typeColorMap = {\n      success: \"#2ecc71\"\n      // Green\n    };\n  }\n  _getLogFn(level) {\n    if (level < 1) {\n      return console.__error || console.error;\n    }\n    if (level === 1) {\n      return console.__warn || console.warn;\n    }\n    return console.__log || console.log;\n  }\n  log(logObj) {\n    const consoleLogFn = this._getLogFn(logObj.level);\n    const type = logObj.type === \"log\" ? \"\" : logObj.type;\n    const tag = logObj.tag || \"\";\n    const color = this.typeColorMap[logObj.type] || this.levelColorMap[logObj.level] || this.defaultColor;\n    const style = `\n      background: ${color};\n      border-radius: 0.5em;\n      color: white;\n      font-weight: bold;\n      padding: 2px 0.5em;\n    `;\n    const badge = `%c${[tag, type].filter(Boolean).join(\":\")}`;\n    if (typeof logObj.args[0] === \"string\") {\n      consoleLogFn(\n        `${badge}%c ${logObj.args[0]}`,\n        style,\n        // Empty string as style resets to default console style\n        \"\",\n        ...logObj.args.slice(1)\n      );\n    } else {\n      consoleLogFn(badge, style, ...logObj.args);\n    }\n  }\n}\n\nfunction createConsola(options = {}) {\n  const consola2 = createConsola$1({\n    reporters: options.reporters || [new BrowserReporter({})],\n    prompt(message, options2 = {}) {\n      if (options2.type === \"confirm\") {\n        return Promise.resolve(confirm(message));\n      }\n      return Promise.resolve(prompt(message));\n    },\n    ...options\n  });\n  return consola2;\n}\nconst consola = createConsola();\n\nexport { consola, createConsola, consola as default };\n","import type { ExtractPropTypes, PropType } from 'vue'\n\nexport const flipProps = {\n  pages: {\n    type: Array as PropType<string[]>,\n    required: true\n  },\n  pagesHiRes: {\n    type: Array as PropType<string[]>,\n    default: () => []\n  },\n  flipDuration: {\n    type: Number,\n    default: 1000\n  },\n  zoomDuration: {\n    type: Number,\n    default: 500\n  },\n  zooms: {\n    type: Array as PropType<number[]>,\n    default: () => [1, 2, 4]\n  },\n  perspective: {\n    type: Number,\n    default: 2400\n  },\n  nPolygons: {\n    type: Number,\n    default: 10\n  },\n  ambient: {\n    type: Number,\n    default: 0.4\n  },\n  gloss: {\n    type: Number,\n    default: 0.6\n  },\n  swipeMin: {\n    type: Number,\n    default: 3\n  },\n  singlePage: {\n    type: Boolean,\n    default: false\n  },\n  forwardDirection: {\n    validator: (val: string) => val === 'right' || val === 'left',\n    default: 'right'\n  },\n  centering: {\n    type: Boolean,\n    default: true\n  },\n  startPage: {\n    type: Number,\n    default: null\n  },\n  loadingImage: {\n    type: String,\n    default: 'spinner'\n  },\n  clickToZoom: {\n    type: Boolean,\n    default: true\n  },\n  dragToFlip: {\n    type: Boolean,\n    default: true\n  },\n  wheel: {\n    type: String,\n    default: 'scroll'\n  },\n  pageHotspots: {\n    type: Object as PropType<Record<number, any[]>>,\n    default: () => ({})\n  }\n}\n\nexport declare type FlipProps = Partial<ExtractPropTypes<typeof flipProps>>\n","<template>\n  <div class=\"vue3-flipbook\">\n    <slot\n      v-bind=\"{\n        canFlipLeft,\n        canFlipRight,\n        canZoomIn,\n        canZoomOut,\n        page,\n        numPages,\n        flipLeft,\n        flipRight,\n        zoomIn,\n        zoomOut\n      }\"\n    />\n    <div\n      ref=\"refViewport\"\n      class=\"viewport\"\n      :class=\"viewportClass\"\n      :style=\"viewportStyle\"\n      @touchmove=\"onTouchMove\"\n      @pointermove=\"onPointerMove\"\n      @mousemove=\"onMouseMove\"\n      @touchend=\"onTouchEnd\"\n      @touchcancel=\"onTouchEnd\"\n      @pointerup=\"onPointerUp\"\n      @pointercancel=\"onPointerUp\"\n      @mouseup=\"onMouseUp\"\n      @wheel=\"onWheel($event, hasTouchEvents)\"\n    >\n      <div class=\"flipbook-container\" :style=\"{ transform: `scale(${zoom})` }\">\n        <div\n          class=\"click-to-flip left\"\n          :style=\"{ cursor: canFlipLeft ? 'pointer' : 'auto' }\"\n          @click=\"flipLeft\"\n        />\n        <div\n          class=\"click-to-flip right\"\n          :style=\"{ cursor: canFlipRight ? 'pointer' : 'auto' }\"\n          @click=\"flipRight\"\n        />\n        <div :style=\"{ transform: `translateX(${currentCenterOffset}px)` }\">\n          <!-- Left Page with hotspots -->\n          <div\n            v-if=\"showLeftPage\"\n            class=\"page-container fixed\"\n            :style=\"{\n              width: pageWidth + 'px',\n              height: pageHeight + 'px',\n              left: xMargin + 'px',\n              top: yMargin + 'px',\n              position: 'absolute'\n            }\"\n          >\n            <img\n              class=\"page-image\"\n              :style=\"{\n                width: '100%',\n                height: '100%'\n              }\"\n              :src=\"pageUrlLoading(leftPage, true)\"\n              @load=\"didLoadImage\"\n            />\n\n            <!-- Hotspots overlay on left page -->\n            <div\n              class=\"page-hotspots\"\n              :style=\"{\n                opacity: 1 - flip.opacity,\n                pointerEvents: flip.opacity > 0.1 ? 'none' : 'auto',\n                zIndex: flip.opacity > 0.1 ? 1 : 10\n              }\"\n            >\n              <slot\n                name=\"hotspot\"\n                :hotspots=\"leftPageHotspots\"\n                :page=\"leftPage\"\n              />\n            </div>\n          </div>\n          <!-- Right Page with hotspots -->\n          <div\n            v-if=\"showRightPage\"\n            class=\"page-container fixed\"\n            :style=\"{\n              width: pageWidth + 'px',\n              height: pageHeight + 'px',\n              left: viewWidth / 2 + 'px',\n              top: yMargin + 'px',\n              position: 'absolute'\n            }\"\n          >\n            <img\n              class=\"page-image\"\n              :style=\"{\n                width: '100%',\n                height: '100%'\n              }\"\n              :src=\"pageUrlLoading(rightPage, true)\"\n              @load=\"didLoadImage\"\n            />\n\n            <!-- Hotspots overlay on right page -->\n            <div\n              class=\"page-hotspots\"\n              :style=\"{\n                opacity: 1 - flip.opacity,\n                pointerEvents: flip.opacity > 0.1 ? 'none' : 'auto',\n                zIndex: flip.opacity > 0.1 ? 1 : 10\n              }\"\n            >\n              <slot\n                name=\"hotspot\"\n                :hotspots=\"rightPageHotspots\"\n                :page=\"rightPage\"\n              />\n            </div>\n          </div>\n\n          <div :style=\"{ opacity: flip.opacity }\">\n            <div\n              v-for=\"[key, bgImage, lighting, bgPos, transform, z] in polygonArray\"\n              :key=\"key\"\n              class=\"polygon\"\n              :class=\"{ blank: !bgImage }\"\n              :data-img=\"bgImage\"\n              :style=\"{\n                backgroundImage: bgImage && `url(${loadImage(bgImage)})`,\n                backgroundSize: polygonBgSize,\n                backgroundPosition: bgPos,\n                width: polygonWidth,\n                height: polygonHeight,\n                transform: transform,\n                zIndex: z\n              }\"\n            >\n              <div\n                v-show=\"lighting.length\"\n                class=\"lighting\"\n                :style=\"{ backgroundImage: lighting }\"\n              />\n            </div>\n          </div>\n          <div\n            class=\"bounding-box\"\n            :style=\"{\n              left: boundingLeft + 'px',\n              top: yMargin + 'px',\n              width: boundingRight - boundingLeft + 'px',\n              height: pageHeight + 'px',\n              cursor: cursor\n            }\"\n            @touchstart=\"onTouchStart\"\n            @pointerdown=\"onPointerDown\"\n            @mousedown=\"onMouseDown\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport type { emitEvents } from './index-types'\nimport {\n  calculateThetaAndRadius,\n  calculatePageRotation,\n  easeInOut,\n  calculatePageXAndOrigin,\n  calculatePageMatrix,\n  calculateRotate,\n  computeLighting,\n  calculateXAndZ\n} from './utils.js'\nimport { ref, reactive, computed, onMounted, onBeforeUnmount, watch } from 'vue'\nimport useZoom from './useZoom'\nimport type { TouchPoint } from './useZoom'\nimport useImageLoad from './useImageLoad'\nimport { createConsola } from 'consola'\nimport { flipProps } from './flipProps'\nconst logger = createConsola({\n  level: 4 // 设置日志级别为 silent\n})\n\n// 现在，这个文件中的 consola 日志将不会被输出\nlogger.info('This will not be logged')\nconst emit = defineEmits<emitEvents>()\nconst props = defineProps(flipProps)\n\nconst viewWidth = ref<number>(0)\nconst viewHeight = ref<number>(0)\nconst displayedPages = ref<number>(0)\nconst currentPage = ref<number>(0)\nconst firstPage = ref<number>(0)\nconst secondPage = ref<number>(1)\nconst touchStartX = ref<number | null>(null)\nconst touchStartY = ref<number | null>(null)\nconst maxMove = ref<number>(0)\nconst activeCursor = ref<string | null>(null)\nconst hasTouchEvents = ref<boolean>(false)\nconst hasPointerEvents = ref<boolean>(false)\nconst minX = ref<number>(Infinity)\nconst maxX = ref<number>(-Infinity)\nconst refViewport = ref<HTMLDivElement>()\nconst flip = reactive({\n  progress: 0,\n  direction: 'right',\n  frontImage: '',\n  backImage: '',\n  auto: false,\n  opacity: 1\n})\n\nconst currentCenterOffset = ref<number>(0)\nconst animatingCenter = ref<boolean>(false)\nconst startScrollLeft = ref<number>(0)\nconst startScrollTop = ref<number>(0)\n\nconst preloadImages = (hiRes: boolean = false): void => {\n  for (let i = currentPage.value - 3; i <= currentPage.value + 3; i++) {\n    pageUrlLoading(i, false) // this preloads image\n  }\n  if (hiRes) {\n    for (let i = currentPage.value; i < currentPage.value + displayedPages.value; i++) {\n      const src = props.pagesHiRes[i]\n      if (src && typeof src === 'string') {\n        new Image().src = src\n      }\n    }\n  }\n}\nconst {\n  zoom,\n  zooming,\n  canZoomIn,\n  canZoomOut,\n  zoomIn,\n  zoomOut,\n  zoomAt,\n  onWheel,\n  scrollLeft,\n  scrollTop\n} = useZoom(refViewport, preloadImages)\nconst { imageWidth, imageHeight, pageUrl, loadImage, pageUrlLoading, didLoadImage } = useImageLoad(\n  preloadImages,\n  zoom,\n  zooming\n)\n\nconst viewportClass = computed(() => ({\n  zoom: zooming.value || zoom.value > 1,\n  'drag-to-scroll': !hasTouchEvents.value\n}))\n\nconst viewportStyle = computed(() => ({\n  cursor: cursor.value == 'grabbing' ? 'grabbing' : 'auto'\n}))\n\nconst canFlipLeft = computed(() => {\n  return props.forwardDirection === 'left' ? canGoForward.value : canGoBack.value\n})\n\nconst canFlipRight = computed(() => {\n  return props.forwardDirection === 'right' ? canGoForward.value : canGoBack.value\n})\n\nconst numPages = computed(() => {\n  return props.pages![0] === null ? props.pages!.length - 1 : props.pages!.length\n})\n\nconst page = computed(() => {\n  return props.pages![0] !== null ? currentPage.value + 1 : Math.max(1, currentPage.value)\n})\n\nconst canGoForward = computed(() => currentPage.value < props.pages!.length - displayedPages.value)\n\nconst canGoBack = computed(\n  () =>\n    currentPage.value >= displayedPages.value &&\n    !(displayedPages.value === 1 && !pageUrl(firstPage.value - 1))\n)\n\nconst leftPage = computed(() => {\n  return props.forwardDirection === 'right' || displayedPages.value === 1\n    ? firstPage.value\n    : secondPage.value\n})\n\nconst rightPage = computed(() => {\n  return props.forwardDirection === 'right' || displayedPages.value === 1\n    ? secondPage.value\n    : firstPage.value\n})\n\nconst showLeftPage = computed(() => pageUrl(leftPage.value))\n\nconst showRightPage = computed(() => pageUrl(rightPage.value) && displayedPages.value === 2)\n\nconst leftPageHotspots = computed(() => {\n  return props.pageHotspots[leftPage.value] || []\n})\n\nconst rightPageHotspots = computed(() => {\n  return props.pageHotspots[rightPage.value] || []\n})\n\nconst cursor = computed(() => {\n  if (activeCursor.value) {\n    return activeCursor.value\n  } else if (props.clickToZoom && canZoomIn.value) {\n    return 'zoom-in'\n  } else if (props.clickToZoom && canZoomOut.value) {\n    return 'zoom-out'\n  } else if (props.dragToFlip) {\n    return 'grab'\n  } else {\n    return 'auto'\n  }\n})\n\nconst xMargin = computed(() => (viewWidth.value - pageWidth.value * displayedPages.value) / 2)\nconst yMargin = computed(() => (viewHeight.value - pageHeight.value) / 2)\n\nconst polygonWidth = computed(() => {\n  let w = pageWidth.value / props.nPolygons\n  w = Math.ceil(w + 1 / zoom.value)\n  return w + 'px'\n})\n\nconst polygonHeight = computed(() => pageHeight.value + 'px')\n\nconst polygonBgSize = computed(() => `${pageWidth.value}px ${pageHeight.value}px`)\n\nconst polygonArray = computed(() => makePolygonArray('front').concat(makePolygonArray('back')))\nconst boundingLeft = computed(() => {\n  if (displayedPages.value === 1) {\n    return xMargin.value\n  } else {\n    let x\n    if (pageUrl(leftPage.value)) {\n      x = xMargin.value\n    } else {\n      x = viewWidth.value / 2\n    }\n    if (x < minX.value) {\n      return x\n    } else {\n      return minX.value\n    }\n  }\n})\n\nconst boundingRight = computed(() => {\n  if (displayedPages.value === 1) {\n    return viewWidth.value - xMargin.value\n  } else {\n    let x = pageUrl(rightPage.value) ? viewWidth.value - xMargin.value : viewWidth.value / 2\n    return x > maxX.value ? x : maxX.value\n  }\n})\n\nconst scrollLeftMin = computed(() => {\n  let w = (boundingRight.value - boundingLeft.value) * zoom.value\n  if (w < viewWidth.value) {\n    return (\n      (boundingLeft.value + (currentCenterOffset.value ?? 0)) * zoom.value -\n      (viewWidth.value - w) / 2\n    )\n  } else {\n    return (boundingLeft.value + (currentCenterOffset.value ?? 0)) * zoom.value\n  }\n})\n\nconst scrollLeftMax = computed(() => {\n  let w = (boundingRight.value - boundingLeft.value) * zoom.value\n  if (w < viewWidth.value) {\n    return (\n      (boundingLeft.value + (currentCenterOffset.value ?? 0)) * zoom.value -\n      (viewWidth.value - w) / 2\n    )\n  } else {\n    return (boundingRight.value + (currentCenterOffset.value ?? 0)) * zoom.value - viewWidth.value\n  }\n})\n\nconst scrollTopMin = computed(() => {\n  let h = pageHeight.value * zoom.value\n  if (h < viewHeight.value) {\n    return yMargin.value * zoom.value - (viewHeight.value - h) / 2\n  } else {\n    return yMargin.value * zoom.value\n  }\n})\n\nconst scrollTopMax = computed(() => {\n  let h = pageHeight.value * zoom.value\n  if (h < viewHeight.value) {\n    return yMargin.value * zoom.value - (viewHeight.value - h) / 2\n  } else {\n    return (yMargin.value + pageHeight.value) * zoom.value - viewHeight.value\n  }\n})\n\nonMounted(() => {\n  setFlipImages(props.forwardDirection)\n  onResize()\n  window.addEventListener('resize', onResize, {\n    passive: true\n  })\n  zoom.value = props.zooms[0]\n  logger.info('props.startPage', props.startPage)\n  goToPage(props.startPage)\n})\n\nonBeforeUnmount(() => {\n  window.removeEventListener('resize', onResize)\n})\n\nconst pageScale = computed(() => {\n  const vw = viewWidth.value / displayedPages.value\n  const xScale = imageWidth.value ? vw / imageWidth.value : 1\n  const yScale = imageHeight.value ? viewHeight.value / imageHeight.value : 1\n  const scale = xScale < yScale ? xScale : yScale\n  return scale < 1 ? scale : 1\n})\n\nconst pageWidth = computed(() =>\n  imageWidth.value ? Math.round(imageWidth.value * pageScale.value) : 1\n)\n\nconst pageHeight = computed(() =>\n  imageHeight.value ? Math.round(imageHeight.value * pageScale.value) : 1\n)\n\nconst onResize = () => {\n  const viewport = refViewport.value\n  if (!viewport) return\n  viewWidth.value = viewport.clientWidth\n  viewHeight.value = viewport.clientHeight\n  displayedPages.value = viewWidth.value > viewHeight.value && !props.singlePage ? 2 : 1\n  if (displayedPages.value === 2) {\n    currentPage.value &= ~1\n  }\n  fixFirstPage()\n  minX.value = Infinity\n  maxX.value = -Infinity\n}\n\nconst fixFirstPage = () => {\n  if (displayedPages.value === 1 && currentPage.value === 0 && props.pages!.length && !pageUrl(0)) {\n    currentPage.value++\n  }\n}\n\nconst flipLeft = () => {\n  if (canFlipLeft.value) {\n    flipStart('left', true)\n  }\n}\n\nconst flipRight = () => {\n  if (canFlipRight.value) {\n    flipStart('right', true)\n  }\n}\n\ntype Polygon = [string, string, string, string, string, number]\ntype PolygonArray = Polygon[]\n\nconst makePolygonArray = (face: string) => {\n  let progress = flip.progress\n  let direction = flip.direction\n  if (displayedPages.value === 1 && direction !== props.forwardDirection) {\n    progress = 1 - progress\n    direction = props.forwardDirection\n  }\n\n  flip.opacity = displayedPages.value === 1 && progress > 0.7 ? 1 - (progress - 0.7) / 0.3 : 1\n\n  let image = face === 'front' ? flip.frontImage : flip.backImage\n  logger.info('flip.backImage', flip.backImage)\n  logger.info('flip.frontImage', flip.frontImage)\n  logger.info('face', face)\n  logger.info('image', image)\n  const polyWidth = pageWidth.value / props.nPolygons\n  const { pageX, originRight } = calculatePageXAndOrigin(\n    face,\n    direction,\n    xMargin.value,\n    displayedPages.value,\n    props.forwardDirection,\n    pageWidth.value,\n    viewWidth.value\n  )\n  const pageRotation = calculatePageRotation(progress, direction, face)\n  const pageMatrix = calculatePageMatrix(\n    pageX,\n    originRight,\n    pageRotation,\n    viewWidth.value,\n    props.perspective,\n    yMargin.value,\n    pageWidth.value\n  )\n  const { theta, radius } = calculateThetaAndRadius(progress, pageWidth.value)\n\n  let radian = 0\n  let dRadian = theta / props.nPolygons\n  let rotate = calculateRotate(theta, dRadian, originRight)\n  let dRotate = (dRadian / Math.PI) * 180\n  if (face === 'back') {\n    rotate = -rotate\n    dRotate = -dRotate\n  }\n\n  minX.value = Infinity\n  maxX.value = -Infinity\n  const polygonArray: PolygonArray = []\n  let tempminX = Infinity\n  let tempmaxX = -Infinity\n\n  for (let i = 0; i < props.nPolygons; i++) {\n    const bgPos = `${(i / (props.nPolygons - 1)) * 100}% 0px`\n    const transformMatrix = pageMatrix.clone()\n    const rad = originRight ? theta - radian : radian\n    const { x, z } = calculateXAndZ(rad, radius, originRight, face, pageWidth.value)\n    transformMatrix.translate3d(x, 0, z)\n    transformMatrix.rotateY(-rotate)\n    const x0 = transformMatrix.transformX(0)\n    const x1 = transformMatrix.transformX(polyWidth)\n    tempminX = Math.min(tempminX, x0, x1)\n    tempmaxX = Math.max(tempmaxX, x0, x1)\n    const lighting =\n      computeLighting(pageRotation - rotate, dRotate, props.ambient, props.gloss) || ''\n    radian += dRadian\n    rotate += dRotate\n    polygonArray.push([\n      `${face}${i}` as string,\n      image as string,\n      lighting as string,\n      bgPos as string,\n      transformMatrix.toString() as string,\n      Math.abs(Math.round(z)) as number\n    ])\n  }\n  maxX.value = tempmaxX\n  minX.value = tempminX\n  return polygonArray\n}\n\nconst setFlipImages = (direction: string) => {\n  if (direction !== props.forwardDirection) {\n    flip.frontImage =\n      displayedPages.value === 1 ? pageUrl(currentPage.value - 1) : pageUrl(firstPage.value)\n    flip.backImage =\n      displayedPages.value === 1 ? '' : pageUrl(currentPage.value - displayedPages.value + 1)\n  } else {\n    flip.frontImage =\n      displayedPages.value === 1 ? pageUrl(currentPage.value) : pageUrl(secondPage.value)\n    flip.backImage =\n      displayedPages.value === 1 ? '' : pageUrl(currentPage.value + displayedPages.value)\n  }\n}\nconst flipStart = (direction: string, auto: boolean) => {\n  setFlipImages(direction)\n\n  flip.direction = direction\n  flip.progress = 0\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      if (flip.direction !== props.forwardDirection) {\n        if (displayedPages.value === 2) {\n          firstPage.value = currentPage.value - displayedPages.value\n        }\n      } else {\n        if (displayedPages.value === 1) {\n          firstPage.value = currentPage.value + displayedPages.value\n        } else {\n          secondPage.value = currentPage.value + 1 + displayedPages.value\n        }\n      }\n      if (auto) {\n        flipAuto(true)\n      }\n    })\n  })\n}\n\n// 创建一个动画\nconst flipAuto = (shouldEase: boolean) => {\n  const startTime = Date.now()\n  const duration = props.flipDuration * (1 - flip.progress)\n  const startRatio = flip.progress\n  flip.auto = true\n  flip.direction === 'left'\n    ? emit(`flip-left-start`, page.value)\n    : emit(`flip-right-start`, page.value)\n  const animate = () => {\n    const elapsedTime = Date.now() - startTime\n    let ratio = startRatio + elapsedTime / duration\n    ratio = ratio > 1 ? 1 : ratio\n    flip.progress = shouldEase ? easeInOut(ratio) : ratio\n    if (ratio < 1) {\n      requestAnimationFrame(animate)\n    } else {\n      if (flip.direction !== props.forwardDirection) {\n        currentPage.value -= displayedPages.value\n      } else {\n        currentPage.value += displayedPages.value\n      }\n      flip.direction === 'left'\n        ? emit(`flip-left-end`, page.value)\n        : emit(`flip-right-end`, page.value)\n      flip.auto = false\n    }\n  }\n  animate()\n}\n\nconst flipRevert = () => {\n  const t0 = Date.now()\n  const duration = props.flipDuration * flip.progress\n  const startRatio = flip.progress\n  flip.auto = true\n  const animate = () => {\n    requestAnimationFrame(() => {\n      const t = Date.now() - t0\n      let ratio = startRatio - (startRatio * t) / duration\n      ratio = ratio < 0 ? 0 : ratio\n      flip.progress = ratio\n      if (ratio > 0) {\n        animate()\n      } else {\n        firstPage.value = currentPage.value\n        secondPage.value = currentPage.value + 1\n        // if (displayedPages.value === 1 && flip.direction !== props.forwardDirection) {\n        //   flip.direction = null\n        // } else {\n        //   onImageLoad(1, () => {\n        //     flip.direction = null\n        //   })\n        // }\n        flip.auto = false\n      }\n    })\n  }\n  animate()\n}\n\nconst dragScroll = (x: number, y: number) => {\n  scrollLeft.value = startScrollLeft.value - x\n  scrollTop.value = startScrollTop.value - y\n}\n\nconst scrollLeftLimited = computed(() => {\n  return Math.min(scrollLeftMax.value, Math.max(scrollLeftMin.value, scrollLeft.value))\n})\n\nconst scrollTopLimited = computed(() => {\n  return Math.min(scrollTopMax.value, Math.max(scrollTopMin.value, scrollTop.value))\n})\n\nwatch(scrollLeftLimited, (val) => {\n  if (refViewport.value) {\n    refViewport.value.scrollLeft = val\n  }\n})\n\nwatch(scrollTopLimited, (val) => {\n  if (refViewport.value) {\n    refViewport.value.scrollTop = val\n  }\n})\n\nconst swipeStart = (touch: TouchPoint) => {\n  if (refViewport.value) {\n    touchStartX.value = touch.pageX\n    touchStartY.value = touch.pageY\n    maxMove.value = 0\n    if (zoom.value <= 1) {\n      if (props.dragToFlip) {\n        activeCursor.value = 'grab'\n      }\n    } else {\n      startScrollLeft.value = refViewport.value.scrollLeft\n      startScrollTop.value = refViewport.value.scrollTop\n      activeCursor.value = 'all-scroll'\n    }\n  }\n}\n\nconst swipeMove = (touch: TouchPoint) => {\n  if (!touchStartX.value || !touchStartY.value) return\n  const x = touch.pageX - touchStartX.value\n  const y = touch.pageY - touchStartY.value\n  maxMove.value = Math.max(maxMove.value, Math.abs(x), Math.abs(y))\n  if (zoom.value > 1) {\n    dragScroll(x, y)\n    return\n  }\n  if (!props.dragToFlip || Math.abs(y) > Math.abs(x)) return\n  activeCursor.value = 'grabbing'\n  const direction = x > 0 ? 'left' : 'right'\n  const canFlip = x > 0 ? canFlipLeft.value : canFlipRight.value\n  const swipeMin = x > 0 ? props.swipeMin : -props.swipeMin\n  if (canFlip && x >= swipeMin) {\n    flipStart(direction, false)\n  }\n  if (flip.direction === direction) {\n    flip.progress = Math.abs(x) / pageWidth.value\n    if (flip.progress > 1) {\n      flip.progress = 1\n    }\n  }\n  return true\n}\n\nconst swipeEnd = (touch: TouchPoint) => {\n  if (!touchStartX.value) return\n  if (props.clickToZoom && maxMove.value < props.swipeMin) {\n    zoomAt(touch)\n  }\n  if (flip.direction !== null && !flip.auto) {\n    if (flip.progress > 1 / 4) {\n      flipAuto(false)\n    } else {\n      flipRevert()\n    }\n  }\n  touchStartX.value = null\n  activeCursor.value = null\n}\n\nconst onTouchStart = (ev: TouchEvent) => {\n  hasTouchEvents.value = true\n  swipeStart(ev.changedTouches[0])\n}\n\nconst onTouchMove = (ev: TouchEvent) => {\n  if (swipeMove(ev.changedTouches[0])) {\n    ev.preventDefault()\n  }\n}\n\nconst onTouchEnd = (ev: TouchEvent) => {\n  swipeEnd(ev.changedTouches[0])\n}\n\nconst onPointerDown = (event: PointerEvent) => {\n  hasPointerEvents.value = true\n  if (hasTouchEvents.value) return\n  if (event.button !== 0) return // Ignore anything but left-click\n  swipeStart(event)\n  if (event.target) {\n    const targetElement = event.target as Element\n    targetElement.setPointerCapture(event.pointerId)\n  }\n}\n\nconst onPointerMove = (ev: PointerEvent) => {\n  if (!hasTouchEvents.value) {\n    swipeMove(ev)\n  }\n}\n\nconst onPointerUp = (event: PointerEvent) => {\n  if (hasTouchEvents.value) return\n  swipeEnd(event)\n  if (event.target) {\n    const targetElement = event.target as Element\n    targetElement.releasePointerCapture(event.pointerId)\n  }\n}\n\nconst onMouseDown = (event: MouseEvent) => {\n  if (hasTouchEvents.value || hasPointerEvents.value) return\n  if (event.button !== 0) return // Ignore anything but left-click\n  swipeStart(event)\n}\n\nconst onMouseMove = (ev: MouseEvent) => {\n  if (!hasTouchEvents.value || !hasPointerEvents.value) {\n    swipeMove(ev)\n  }\n}\n\nconst onMouseUp = (ev: MouseEvent) => {\n  if (!hasTouchEvents.value || !hasPointerEvents.value) {\n    swipeEnd(ev)\n  }\n}\n\nconst goToPage = (p: number) => {\n  if (p === null || p === page.value) return\n\n  currentPage.value =\n    (props.pages ?? [])[0] === null && displayedPages.value === 2 && p === 1 ? 0 : p - 1\n\n  minX.value = Infinity\n  maxX.value = -Infinity\n  currentCenterOffset.value = centerOffset.value\n}\n\nwatch(currentPage, () => {\n  firstPage.value = currentPage.value\n  secondPage.value = currentPage.value + 1\n  preloadImages()\n})\n\nconst centerOffset = computed(() => {\n  let retval = props.centering\n    ? Math.round(viewWidth.value / 2 - (boundingLeft.value + boundingRight.value) / 2)\n    : 0\n\n  return retval\n})\n\nwatch(centerOffset, (val) => {\n  if (animatingCenter.value) return\n  if (currentCenterOffset.value === 0 && imageWidth.value !== null) {\n    currentCenterOffset.value = val\n  }\n  const animate = () => {\n    requestAnimationFrame(() => {\n      const rate = 0.1\n      const diff = centerOffset.value - currentCenterOffset.value\n      if (Math.abs(diff) < 0.5) {\n        currentCenterOffset.value = centerOffset.value\n        animatingCenter.value = false\n      } else {\n        currentCenterOffset.value += diff * rate\n        animate()\n      }\n    })\n  }\n  animatingCenter.value = true\n  animate()\n})\n\nwatch(\n  () => props.pages,\n  (after, before) => {\n    setFlipImages(props.forwardDirection)\n    fixFirstPage()\n    if (!before?.length && after?.length) {\n      if (props.startPage > 1 && after[0] == null) {\n        currentPage.value++\n      }\n    }\n  }\n)\n\nwatch(\n  () => props.startPage,\n  (p) => {\n    goToPage(p)\n  }\n)\n</script>\n\n<style lang=\"scss\">\n.vue3-flipbook {\n  .viewport {\n    left: 0;\n    -webkit-overflow-scrolling: touch;\n    width: 100%;\n    height: 100%;\n  }\n\n  .viewport.zoom {\n    overflow: scroll;\n  }\n\n  .viewport.zoom.drag-to-scroll {\n    overflow: hidden;\n  }\n\n  .flipbook-container {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    user-select: none;\n  }\n\n  .click-to-flip {\n    position: absolute;\n    width: 50%;\n    height: 100%;\n    top: 0;\n    user-select: none;\n  }\n\n  .click-to-flip.left {\n    left: 0;\n  }\n\n  .click-to-flip.right {\n    right: 0;\n  }\n\n  .bounding-box {\n    position: absolute;\n    user-select: none;\n  }\n\n  .page {\n    position: absolute;\n    backface-visibility: hidden;\n  }\n\n  .polygon {\n    position: absolute;\n    top: 0;\n    left: 0;\n    background-repeat: no-repeat;\n    backface-visibility: hidden;\n    transform-origin: center left;\n  }\n\n  .polygon.blank {\n    background-color: #ddd;\n  }\n\n  .polygon .lighting {\n    width: 100%;\n    height: 100%;\n  }\n\n  .page-container {\n    position: absolute;\n  }\n\n  .page-image {\n    display: block;\n    width: 100%;\n    height: 100%;\n    backface-visibility: hidden;\n  }\n\n  .page-hotspots {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    transition: opacity 0.2s ease, z-index 0s;\n  }\n}\n</style>\n","import { App, Plugin } from 'vue'\nimport Flipbook from './Flipbook.vue'\n\nFlipbook.install = (app: App) => {\n  app.component(Flipbook.name, Flipbook)\n  return app\n}\n\nexport default Flipbook as typeof Flipbook & Plugin\n"],"names":["format","source","values","value","matrix","identity","i","multiply","matrixA","matrixB","fma","fmb","product","row","j","k","col","result","perspective","distance","rotateY","angle","theta","toString","translate","distanceX","distanceY","translate3d","distanceZ","Matrix","arg","__publicField","m","d","x","y","z","deg","calculatePageRotation","progress","direction","face","pageRotation","easeIn","easeOut","easeInOut","calculatePageXAndOrigin","xMargin","displayedPages","forwardDirection","pageWidth","viewWidth","pageX","originRight","calculatePageMatrix","yMargin","pageMatrix","calculateThetaAndRadius","radius","calculateRotate","dRadian","computeLighting","rot","dRotate","ambient","gloss","gradients","lightingPoints","blackness","diffuse","specular","calculateXAndZ","rad","useZoom","refViewport","preloadImages","currentInstance","getCurrentInstance","props","zoom","ref","zoomIndex","zooming","scrollLeft","scrollTop","zoomIn","zoomAt","canZoomIn","zoomTo","zoomOut","canZoomOut","pzoom","viewport","fixedX","fixedY","rect","start","end","startX","startY","containerFixedX","containerFixedY","endX","endY","t0","animate","t","ratio","zoomAtv","computed","ev","hasTouchEvents","useImageLoad","loadedImages","nImageLoad","nImageLoadTrigger","imageLoadCallback","imageWidth","imageHeight","pageUrl","page","hiRes","_a","_b","loadImage","url","img","LogLevels","LogTypes","isObject","_defu","baseObject","defaults","namespace","merger","object","key","createDefu","arguments_","p","c","defu","isPlainObject","obj","isLogObj","paused","queue","Consola","options","types","_normalizeLogLevel","type","level","message","opts","instance","tag","reporter","reporters","stream","data","_queue","item","mockFn","_mockFn","isRaw","args","logObj","resolveLog","newLog","repeated","args2","diffTime","serializedLog","isSameLog","input","defaultLevel","createConsola","BrowserReporter","consoleLogFn","style","badge","createConsola$1","options2","flipProps","val","logger","emit","__emit","__props","viewHeight","currentPage","firstPage","secondPage","touchStartX","touchStartY","maxMove","activeCursor","hasPointerEvents","minX","maxX","flip","reactive","currentCenterOffset","animatingCenter","startScrollLeft","startScrollTop","pageUrlLoading","src","onWheel","didLoadImage","viewportClass","viewportStyle","cursor","canFlipLeft","canGoForward","canGoBack","canFlipRight","numPages","leftPage","rightPage","showLeftPage","showRightPage","leftPageHotspots","rightPageHotspots","pageHeight","polygonWidth","w","polygonHeight","polygonBgSize","polygonArray","makePolygonArray","boundingLeft","boundingRight","scrollLeftMin","scrollLeftMax","scrollTopMin","h","scrollTopMax","onMounted","setFlipImages","onResize","goToPage","onBeforeUnmount","pageScale","vw","xScale","yScale","scale","fixFirstPage","flipLeft","flipStart","flipRight","image","polyWidth","radian","rotate","tempminX","tempmaxX","bgPos","transformMatrix","x0","x1","lighting","auto","flipAuto","shouldEase","startTime","duration","startRatio","elapsedTime","flipRevert","dragScroll","scrollLeftLimited","scrollTopLimited","watch","swipeStart","touch","swipeMove","canFlip","swipeMin","swipeEnd","onTouchStart","onTouchMove","onTouchEnd","onPointerDown","event","onPointerMove","onPointerUp","onMouseDown","onMouseMove","onMouseUp","centerOffset","diff","after","before","Flipbook","app"],"mappings":"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","x_google_ignoreList":[0,5,6]}