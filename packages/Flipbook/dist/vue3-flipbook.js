"use strict";var Nt=Object.defineProperty;var Ct=(n,e,o)=>e in n?Nt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var je=(n,e,o)=>(Ct(n,typeof e!="symbol"?e+"":e,o),o);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue");/*! @license Rematrix v0.7.2

	Copyright 2021 Julian Lloyd.

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in
	all copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	THE SOFTWARE.
*/function ke(n){if(n&&n.constructor===Array){var e=n.filter(function(r){return typeof r=="number"}).filter(function(r){return!isNaN(r)});if(n.length===6&&e.length===6){var o=W();return o[0]=e[0],o[1]=e[1],o[4]=e[2],o[5]=e[3],o[12]=e[4],o[13]=e[5],o}else if(n.length===16&&e.length===16)return n}throw new TypeError("Expected a `number[]` with length 6 or 16.")}function W(){for(var n=[],e=0;e<16;e++)e%5==0?n.push(1):n.push(0);return n}function At(n,e){for(var o=ke(n),r=ke(e),a=[],i=0;i<4;i++)for(var c=[o[i],o[i+4],o[i+8],o[i+12]],s=0;s<4;s++){var u=s*4,m=[r[u],r[u+1],r[u+2],r[u+3]],b=c[0]*m[0]+c[1]*m[1]+c[2]*m[2]+c[3]*m[3];a[i+u]=b}return a}function $t(n){var e=W();return e[11]=-1/n,e}function Rt(n){var e=Math.PI/180*n,o=W();return o[0]=o[10]=Math.cos(e),o[2]=o[8]=Math.sin(e),o[2]*=-1,o}function Bt(n){return"matrix3d("+ke(n).join(", ")+")"}function Xt(n,e){var o=W();return o[12]=n,e&&(o[13]=e),o}function Ht(n,e,o){var r=W();return n!==void 0&&e!==void 0&&o!==void 0&&(r[12]=n,r[13]=e,r[14]=o),r}class Te{constructor(e){je(this,"m");e?this.m=[...e]:this.m=W()}clone(){return new Te(this.m)}multiply(e){this.m=At(this.m,e)}perspective(e){this.multiply($t(e))}transformX(e){return(e*this.m[0]+this.m[12])/(e*this.m[3]+this.m[15])}translate(e,o){this.multiply(Xt(e,o))}translate3d(e,o,r){this.multiply(Ht(e,o,r))}rotateY(e){this.multiply(Rt(e))}toString(){return Bt(this.m)}}const Ot=(n,e,o)=>{let r=0;return n>.5&&(r=-(n-.5)*2*180),e==="left"&&(r=-r),o==="back"&&(r+=180),r},Je=n=>Math.pow(n,2),Yt=n=>1-Je(1-n),Ke=n=>n<.5?Je(n*2)/2:.5+Yt((n-.5)*2)/2,Vt=(n,e,o,r,a,i,c)=>{let s=o,u=!1;return r===1?a==="right"?n==="back"&&(u=!0,s=o-i):e==="left"?n==="back"?s=i-o:u=!0:n==="front"?s=i-o:u=!0:e==="left"?n==="back"?s=c/2:u=!0:n==="front"?s=c/2:u=!0,{pageX:s,originRight:u}},Wt=(n,e,o,r,a,i,c)=>{const s=new Te;return s.translate(r/2),s.perspective(a),s.translate(-r/2),s.translate(n,i),o&&(e&&s.translate(c),s.rotateY(o),e&&s.translate(-c)),s},Zt=(n,e)=>{let o;n<.5?o=n*2*Math.PI:o=(1-(n-.5)*2)*Math.PI,o==0&&(o=1e-9);const r=e/o;return{theta:o,radius:r}},qt=(n,e,o)=>o?-n/Math.PI*180+e/2/Math.PI*180:e/2/Math.PI*180,jt=(n,e,o,r)=>{const a=[],i=[-.5,-.25,0,.25,.5];if(o<1){const c=1-o,s=i.map(u=>(1-Math.cos((n-e*u)/180*Math.PI))*c);a.push(`linear-gradient(to right, rgba(0, 0, 0, ${s[0]}), rgba(0, 0, 0, ${s[1]}) 25%, rgba(0, 0, 0, ${s[2]}) 50%, rgba(0, 0, 0, ${s[3]}) 75%, rgba(0, 0, 0, ${s[4]}))`)}if(r>0){const u=i.map(m=>Math.max(Math.cos((n+30-e*m)/180*Math.PI)**200,Math.cos((n-30-e*m)/180*Math.PI)**200));a.push(`linear-gradient(to right, rgba(255, 255, 255, ${u[0]*r}), rgba(255, 255, 255, ${u[1]*r}) 25%, rgba(255, 255, 255, ${u[2]*r}) 50%, rgba(255, 255, 255, ${u[3]*r}) 75%, rgba(255, 255, 255, ${u[4]*r}))`)}return a.join(",")},Ut=(n,e,o,r,a)=>{let i=Math.sin(n)*e;o&&(i=a-i);let c=(1-Math.cos(n))*e;return r==="back"&&(c=-c),{x:i,z:c}};function Gt(n,e){const o=t.getCurrentInstance();if(!o)throw new Error("useDrawer() can only be used inside setup() or functional components!");const r=o.props,a=t.ref(1);let i=0;const c=t.ref(!1),s=t.ref(0),u=t.ref(0),m=v=>{A.value&&(i+=1,r.zooms&&S(r.zooms[i],v))},b=v=>{E.value&&(i-=1,r.zooms&&S(r.zooms[i],v))},S=(v,w)=>{const M=n==null?void 0:n.value;if(M){let L,f;if(w){const X=M.getBoundingClientRect();L=w.pageX-X.left,f=w.pageY-X.top}else L=M.clientWidth/2,f=M.clientHeight/2;const I=a.value,$=v,H=M.scrollLeft,O=M.scrollTop,Z=L+H,h=f+O,q=Z/I*$-L,j=h/I*$-f,te=Date.now();c.value=!0,o==null||o.emit("zoom-start",v);const oe=()=>{requestAnimationFrame(()=>{const X=Date.now()-te;let F=X/r.zoomDuration;F=F>1?1:F,F=Ke(F),a.value=I+($-I)*F,s.value=H+(q-H)*F,u.value=O+(j-O)*F,X<r.zoomDuration?oe():(o==null||o.emit("zoom-end",v),c.value=!1,a.value=v,s.value=q,u.value=j)})};oe(),$>1&&e(!0)}},C=v=>{i=(i+1)%r.zooms.length,S(r.zooms[i],v)},A=t.computed(()=>!c.value&&i<r.zooms.length-1),E=t.computed(()=>!c.value&&i>0);return{zoom:a,zooming:c,canZoomIn:A,canZoomOut:E,zoomIn:m,zoomOut:b,zoomAt:C,onWheel:(v,w)=>{r.wheel==="scroll"&&a.value>1&&!w&&n.value&&(s.value=n.value.scrollLeft+v.deltaX,u.value=n.value.scrollTop+v.deltaY,v.cancelable&&v.preventDefault()),r.wheel==="zoom"&&(v.deltaY>=100?(b(v),v.preventDefault()):v.deltaY<=-100&&(m(v),v.preventDefault()))},scrollLeft:s,scrollTop:u}}function Jt(n,e,o){const r=t.ref({}),a=t.ref(0),i=t.ref(0),c=t.ref(),s=t.ref(null),u=t.ref(null),m=t.getCurrentInstance();if(!m)throw new Error("useDrawer() can only be used inside setup() or functional components!");const b=m.props,S=(d,v=!1)=>{var w,M;return d<1?"":v&&e.value>1&&!o.value?(d<b.pagesHiRes.length?(w=b.pagesHiRes)==null?void 0:w[d]:"")||"":(d<b.pages.length?(M=b.pages)==null?void 0:M[d]:"")||""},C=d=>{if(s.value===null)return d;if(r.value[d])return d;{const v=new Image;return v.onload=()=>{r.value[d]=!0},v.src=d,b.loadingImage||""}};return{imageWidth:s,imageHeight:u,pageUrl:S,loadImage:C,pageUrlLoading:(d,v=!1)=>{const w=S(d,v);return v&&e.value>1&&!o.value?w:w&&C(w)},didLoadImage:d=>{s.value===null&&(s.value=d.target.naturalWidth,u.value=d.target.naturalHeight,n()),c.value&&(++a.value>=i.value&&c.value(),c.value=void 0)}}}const k={silent:Number.NEGATIVE_INFINITY,fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,ready:3,start:3,box:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},Ue={silent:{level:-1},fatal:{level:k.fatal},error:{level:k.error},warn:{level:k.warn},log:{level:k.log},info:{level:k.info},success:{level:k.success},fail:{level:k.fail},ready:{level:k.info},start:{level:k.info},box:{level:k.info},debug:{level:k.debug},trace:{level:k.trace},verbose:{level:k.verbose}};function Le(n){return n!==null&&typeof n=="object"}function Se(n,e,o=".",r){if(!Le(e))return Se(n,{},o,r);const a=Object.assign({},e);for(const i in n){if(i==="__proto__"||i==="constructor")continue;const c=n[i];c!=null&&(r&&r(a,i,c,o)||(Array.isArray(c)&&Array.isArray(a[i])?a[i]=[...c,...a[i]]:Le(c)&&Le(a[i])?a[i]=Se(c,a[i],(o?`${o}.`:"")+i.toString(),r):a[i]=c))}return a}function Kt(n){return(...e)=>e.reduce((o,r)=>Se(o,r,"",n),{})}const Qt=Kt();function eo(n){return Object.prototype.toString.call(n)==="[object Object]"}function to(n){return!(!eo(n)||!n.message&&!n.args||n.stack)}let Pe=!1;const Ge=[];class _{constructor(e={}){const o=e.types||Ue;this.options=Qt({...e,defaults:{...e.defaults},level:ze(e.level,o),reporters:[...e.reporters||[]]},{types:Ue,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const r in o){const a={type:r,...this.options.defaults,...o[r]};this[r]=this._wrapLogFn(a),this[r].raw=this._wrapLogFn(a,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=ze(e,this.options.types,this.options.level)}prompt(e,o){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(e,o)}create(e){const o=new _({...this.options,...e});return this._mockFn&&o.mockTypes(this._mockFn),o}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){const o=this.options.reporters.indexOf(e);if(o>=0)return this.options.reporters.splice(o,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const e in this.options.types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(const e in this.options.types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(e,o){e&&(e.__write||(e.__write=e.write),e.write=r=>{this[o].raw(String(r).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){Pe=!0}resumeLogs(){Pe=!1;const e=Ge.splice(0);for(const o of e)o[0]._logFn(o[1],o[2])}mockTypes(e){const o=e||this.options.mockFn;if(this._mockFn=o,typeof o=="function")for(const r in this.options.types)this[r]=o(r,this.options.types[r])||this[r],this[r].raw=this[r]}_wrapLogFn(e,o){return(...r)=>{if(Pe){Ge.push([this,e,r,o]);return}return this._logFn(e,r,o)}}_logFn(e,o,r){if((e.level||0)>this.level)return!1;const a={date:new Date,args:[],...e,level:ze(e.level,this.options.types)};!r&&o.length===1&&to(o[0])?Object.assign(a,o[0]):a.args=[...o],a.message&&(a.args.unshift(a.message),delete a.message),a.additional&&(Array.isArray(a.additional)||(a.additional=a.additional.split(`
`)),a.args.push(`
`+a.additional.join(`
`)),delete a.additional),a.type=typeof a.type=="string"?a.type.toLowerCase():"log",a.tag=typeof a.tag=="string"?a.tag:"";const i=(s=!1)=>{const u=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&u>0){const m=[...this._lastLog.object.args];u>1&&m.push(`(repeated ${u} times)`),this._log({...this._lastLog.object,args:m}),this._lastLog.count=1}s&&(this._lastLog.object=a,this._log(a))};clearTimeout(this._lastLog.timeout);const c=this._lastLog.time&&a.date?a.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=a.date,c<this.options.throttle)try{const s=JSON.stringify([a.type,a.tag,a.args]),u=this._lastLog.serialized===s;if(this._lastLog.serialized=s,u&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(i,this.options.throttle);return}}catch{}i(!0)}_log(e){for(const o of this.options.reporters)o.log(e,{options:this.options})}}function ze(n,e={},o=3){return n===void 0?o:typeof n=="number"?n:e[n]&&e[n].level!==void 0?e[n].level:o}_.prototype.add=_.prototype.addReporter;_.prototype.remove=_.prototype.removeReporter;_.prototype.clear=_.prototype.removeReporter;_.prototype.withScope=_.prototype.withTag;_.prototype.mock=_.prototype.mockTypes;_.prototype.pause=_.prototype.pauseLogs;_.prototype.resume=_.prototype.resumeLogs;function oo(n={}){return new _(n)}class ao{constructor(e){this.options={...e},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(e){return e<1?console.__error||console.error:e===1?console.__warn||console.warn:console.__log||console.log}log(e){const o=this._getLogFn(e.level),r=e.type==="log"?"":e.type,a=e.tag||"",c=`
      background: ${this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor};
      border-radius: 0.5em;
      color: white;
      font-weight: bold;
      padding: 2px 0.5em;
    `,s=`%c${[a,r].filter(Boolean).join(":")}`;typeof e.args[0]=="string"?o(`${s}%c ${e.args[0]}`,c,"",...e.args.slice(1)):o(s,c,...e.args)}}function Qe(n={}){return oo({reporters:n.reporters||[new ao({})],prompt(o,r={}){return r.type==="confirm"?Promise.resolve(confirm(o)):Promise.resolve(prompt(o))},...n})}Qe();const lo={pages:{type:Array,required:!0},pagesHiRes:{type:Array,default:()=>[]},flipDuration:{type:Number,default:1e3},zoomDuration:{type:Number,default:500},zooms:{type:Array,default:()=>[1,2,4]},perspective:{type:Number,default:2400},nPolygons:{type:Number,default:10},ambient:{type:Number,default:.4},gloss:{type:Number,default:.6},swipeMin:{type:Number,default:3},singlePage:{type:Boolean,default:!1},forwardDirection:{validator:n=>n==="right"||n==="left",default:"right"},centering:{type:Boolean,default:!0},startPage:{type:Number,default:null},loadingImage:{type:String,default:"spinner"},clickToZoom:{type:Boolean,default:!0},dragToFlip:{type:Boolean,default:!0},wheel:{type:String,default:"scroll"},pageHotspots:{type:Object,default:()=>({})}},no={class:"vue3-flipbook"},ro=["src"],so=["src"],io=["data-img"],pe=t.defineComponent({__name:"Flipbook",props:lo,emits:["flip-left-start","flip-left-end","flip-right-start","flip-right-end","zoom-start","zoom-end"],setup(n,{emit:e}){const o=Qe({level:4});o.info("This will not be logged");const r=e,a=n,i=t.ref(0),c=t.ref(0),s=t.ref(0),u=t.ref(0),m=t.ref(0),b=t.ref(1),S=t.ref(null),C=t.ref(null),A=t.ref(0),E=t.ref(null),d=t.ref(!1),v=t.ref(!1),w=t.ref(1/0),M=t.ref(-1/0),L=t.ref(),f=t.reactive({progress:0,direction:"right",frontImage:"",backImage:"",auto:!1,opacity:1}),I=t.ref(0),$=t.ref(!1),H=t.ref(0),O=t.ref(0),Z=(l=!1)=>{for(let p=u.value-3;p<=u.value+3;p++)fe(p,!1);if(l)for(let p=u.value;p<u.value+s.value;p++){const g=a.pagesHiRes[p];g&&typeof g=="string"&&(new Image().src=g)}},{zoom:h,zooming:q,canZoomIn:j,canZoomOut:te,zoomIn:oe,zoomOut:X,zoomAt:F,onWheel:et,scrollLeft:xe,scrollTop:De}=Gt(L,Z),{imageWidth:U,imageHeight:ae,pageUrl:T,loadImage:tt,pageUrlLoading:fe,didLoadImage:le}=Jt(Z,h,q),ot=t.computed(()=>({zoom:q.value||h.value>1,"drag-to-scroll":!d.value})),at=t.computed(()=>({cursor:Ne.value=="grabbing"?"grabbing":"auto"})),ne=t.computed(()=>a.forwardDirection==="left"?Ee.value:Fe.value),re=t.computed(()=>a.forwardDirection==="right"?Ee.value:Fe.value),lt=t.computed(()=>a.pages[0]===null?a.pages.length-1:a.pages.length),Y=t.computed(()=>a.pages[0]!==null?u.value+1:Math.max(1,u.value)),Ee=t.computed(()=>u.value<a.pages.length-s.value),Fe=t.computed(()=>u.value>=s.value&&!(s.value===1&&!T(m.value-1))),G=t.computed(()=>a.forwardDirection==="right"||s.value===1?m.value:b.value),J=t.computed(()=>a.forwardDirection==="right"||s.value===1?b.value:m.value),nt=t.computed(()=>T(G.value)),rt=t.computed(()=>T(J.value)&&s.value===2),st=t.computed(()=>a.pageHotspots[G.value]||[]),it=t.computed(()=>a.pageHotspots[J.value]||[]),Ne=t.computed(()=>E.value?E.value:a.clickToZoom&&j.value?"zoom-in":a.clickToZoom&&te.value?"zoom-out":a.dragToFlip?"grab":"auto"),V=t.computed(()=>(i.value-x.value*s.value)/2),R=t.computed(()=>(c.value-N.value)/2),ut=t.computed(()=>{let l=x.value/a.nPolygons;return l=Math.ceil(l+1/h.value),l+"px"}),ct=t.computed(()=>N.value+"px"),pt=t.computed(()=>`${x.value}px ${N.value}px`),ft=t.computed(()=>Be("front").concat(Be("back"))),B=t.computed(()=>{if(s.value===1)return V.value;{let l;return T(G.value)?l=V.value:l=i.value/2,l<w.value?l:w.value}}),K=t.computed(()=>{if(s.value===1)return i.value-V.value;{let l=T(J.value)?i.value-V.value:i.value/2;return l>M.value?l:M.value}}),vt=t.computed(()=>{let l=(K.value-B.value)*h.value;return l<i.value?(B.value+(I.value??0))*h.value-(i.value-l)/2:(B.value+(I.value??0))*h.value}),gt=t.computed(()=>{let l=(K.value-B.value)*h.value;return l<i.value?(B.value+(I.value??0))*h.value-(i.value-l)/2:(K.value+(I.value??0))*h.value-i.value}),dt=t.computed(()=>{let l=N.value*h.value;return l<c.value?R.value*h.value-(c.value-l)/2:R.value*h.value}),mt=t.computed(()=>{let l=N.value*h.value;return l<c.value?R.value*h.value-(c.value-l)/2:(R.value+N.value)*h.value-c.value});t.onMounted(()=>{ge(a.forwardDirection),ve(),window.addEventListener("resize",ve,{passive:!0}),h.value=a.zooms[0],o.info("props.startPage",a.startPage),Ye(a.startPage)}),t.onBeforeUnmount(()=>{window.removeEventListener("resize",ve)});const Ce=t.computed(()=>{const l=i.value/s.value,p=U.value?l/U.value:1,g=ae.value?c.value/ae.value:1,y=p<g?p:g;return y<1?y:1}),x=t.computed(()=>U.value?Math.round(U.value*Ce.value):1),N=t.computed(()=>ae.value?Math.round(ae.value*Ce.value):1),ve=()=>{const l=L.value;l&&(i.value=l.clientWidth,c.value=l.clientHeight,s.value=i.value>c.value&&!a.singlePage?2:1,s.value===2&&(u.value&=-2),Ae(),w.value=1/0,M.value=-1/0)},Ae=()=>{s.value===1&&u.value===0&&a.pages.length&&!T(0)&&u.value++},$e=()=>{ne.value&&de("left",!0)},Re=()=>{re.value&&de("right",!0)},Be=l=>{let p=f.progress,g=f.direction;s.value===1&&g!==a.forwardDirection&&(p=1-p,g=a.forwardDirection),f.opacity=s.value===1&&p>.7?1-(p-.7)/.3:1;let y=l==="front"?f.frontImage:f.backImage;o.info("flip.backImage",f.backImage),o.info("flip.frontImage",f.frontImage),o.info("face",l),o.info("image",y);const D=x.value/a.nPolygons,{pageX:P,originRight:z}=Vt(l,g,V.value,s.value,a.forwardDirection,x.value,i.value),ie=Ot(p,g,l),St=Wt(P,z,ie,i.value,a.perspective,R.value,x.value),{theta:we,radius:Tt}=Zt(p,x.value);let be=0,_e=we/a.nPolygons,Q=qt(we,_e,z),ue=_e/Math.PI*180;l==="back"&&(Q=-Q,ue=-ue),w.value=1/0,M.value=-1/0;const Ve=[];let Me=1/0,Ie=-1/0;for(let ce=0;ce<a.nPolygons;ce++){const xt=`${ce/(a.nPolygons-1)*100}% 0px`,ee=St.clone(),Dt=z?we-be:be,{x:Et,z:We}=Ut(Dt,Tt,z,l,x.value);ee.translate3d(Et,0,We),ee.rotateY(-Q);const Ze=ee.transformX(0),qe=ee.transformX(D);Me=Math.min(Me,Ze,qe),Ie=Math.max(Ie,Ze,qe);const Ft=jt(ie-Q,ue,a.ambient,a.gloss)||"";be+=_e,Q+=ue,Ve.push([`${l}${ce}`,y,Ft,xt,ee.toString(),Math.abs(Math.round(We))])}return M.value=Ie,w.value=Me,Ve},ge=l=>{l!==a.forwardDirection?(f.frontImage=s.value===1?T(u.value-1):T(m.value),f.backImage=s.value===1?"":T(u.value-s.value+1)):(f.frontImage=s.value===1?T(u.value):T(b.value),f.backImage=s.value===1?"":T(u.value+s.value))},de=(l,p)=>{ge(l),f.direction=l,f.progress=0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{f.direction!==a.forwardDirection?s.value===2&&(m.value=u.value-s.value):s.value===1?m.value=u.value+s.value:b.value=u.value+1+s.value,p&&Xe(!0)})})},Xe=l=>{const p=Date.now(),g=a.flipDuration*(1-f.progress),y=f.progress;f.auto=!0,f.direction==="left"?r("flip-left-start",Y.value):r("flip-right-start",Y.value);const D=()=>{const P=Date.now()-p;let z=y+P/g;z=z>1?1:z,f.progress=l?Ke(z):z,z<1?requestAnimationFrame(D):(f.direction!==a.forwardDirection?u.value-=s.value:u.value+=s.value,f.direction==="left"?r("flip-left-end",Y.value):r("flip-right-end",Y.value),f.auto=!1)};D()},ht=()=>{const l=Date.now(),p=a.flipDuration*f.progress,g=f.progress;f.auto=!0;const y=()=>{requestAnimationFrame(()=>{const D=Date.now()-l;let P=g-g*D/p;P=P<0?0:P,f.progress=P,P>0?y():(m.value=u.value,b.value=u.value+1,f.auto=!1)})};y()},yt=(l,p)=>{xe.value=H.value-l,De.value=O.value-p},wt=t.computed(()=>Math.min(gt.value,Math.max(vt.value,xe.value))),bt=t.computed(()=>Math.min(mt.value,Math.max(dt.value,De.value)));t.watch(wt,l=>{L.value&&(L.value.scrollLeft=l)}),t.watch(bt,l=>{L.value&&(L.value.scrollTop=l)});const me=l=>{L.value&&(S.value=l.pageX,C.value=l.pageY,A.value=0,h.value<=1?a.dragToFlip&&(E.value="grab"):(H.value=L.value.scrollLeft,O.value=L.value.scrollTop,E.value="all-scroll"))},he=l=>{if(!S.value||!C.value)return;const p=l.pageX-S.value,g=l.pageY-C.value;if(A.value=Math.max(A.value,Math.abs(p),Math.abs(g)),h.value>1){yt(p,g);return}if(!a.dragToFlip||Math.abs(g)>Math.abs(p))return;E.value="grabbing";const y=p>0?"left":"right",D=p>0?ne.value:re.value,P=p>0?a.swipeMin:-a.swipeMin;return D&&p>=P&&de(y,!1),f.direction===y&&(f.progress=Math.abs(p)/x.value,f.progress>1&&(f.progress=1)),!0},ye=l=>{S.value&&(a.clickToZoom&&A.value<a.swipeMin&&F(l),f.direction!==null&&!f.auto&&(f.progress>1/4?Xe(!1):ht()),S.value=null,E.value=null)},_t=l=>{d.value=!0,me(l.changedTouches[0])},Mt=l=>{he(l.changedTouches[0])&&l.preventDefault()},He=l=>{ye(l.changedTouches[0])},It=l=>{v.value=!0,!d.value&&l.button===0&&(me(l),l.target&&l.target.setPointerCapture(l.pointerId))},Lt=l=>{d.value||he(l)},Oe=l=>{d.value||(ye(l),l.target&&l.target.releasePointerCapture(l.pointerId))},Pt=l=>{d.value||v.value||l.button===0&&me(l)},zt=l=>{(!d.value||!v.value)&&he(l)},kt=l=>{(!d.value||!v.value)&&ye(l)},Ye=l=>{l===null||l===Y.value||(u.value=(a.pages??[])[0]===null&&s.value===2&&l===1?0:l-1,w.value=1/0,M.value=-1/0,I.value=se.value)};t.watch(u,()=>{m.value=u.value,b.value=u.value+1,Z()});const se=t.computed(()=>a.centering?Math.round(i.value/2-(B.value+K.value)/2):0);return t.watch(se,l=>{if($.value)return;I.value===0&&U.value!==null&&(I.value=l);const p=()=>{requestAnimationFrame(()=>{const y=se.value-I.value;Math.abs(y)<.5?(I.value=se.value,$.value=!1):(I.value+=y*.1,p())})};$.value=!0,p()}),t.watch(()=>a.pages,(l,p)=>{ge(a.forwardDirection),Ae(),!(p!=null&&p.length)&&(l!=null&&l.length)&&a.startPage>1&&l[0]==null&&u.value++}),t.watch(()=>a.startPage,l=>{Ye(l)}),(l,p)=>(t.openBlock(),t.createElementBlock("div",no,[t.renderSlot(l.$slots,"default",t.normalizeProps(t.guardReactiveProps({canFlipLeft:ne.value,canFlipRight:re.value,canZoomIn:t.unref(j),canZoomOut:t.unref(te),page:Y.value,numPages:lt.value,flipLeft:$e,flipRight:Re,zoomIn:t.unref(oe),zoomOut:t.unref(X)}))),t.createElementVNode("div",{ref_key:"refViewport",ref:L,class:t.normalizeClass(["viewport",ot.value]),style:t.normalizeStyle(at.value),onTouchmove:Mt,onPointermove:Lt,onMousemove:zt,onTouchend:He,onTouchcancel:He,onPointerup:Oe,onPointercancel:Oe,onMouseup:kt,onWheel:p[2]||(p[2]=g=>t.unref(et)(g,d.value))},[t.createElementVNode("div",{class:"flipbook-container",style:t.normalizeStyle({transform:`scale(${t.unref(h)})`})},[t.createElementVNode("div",{class:"click-to-flip left",style:t.normalizeStyle({cursor:ne.value?"pointer":"auto"}),onClick:$e},null,4),t.createElementVNode("div",{class:"click-to-flip right",style:t.normalizeStyle({cursor:re.value?"pointer":"auto"}),onClick:Re},null,4),t.createElementVNode("div",{style:t.normalizeStyle({transform:`translateX(${I.value}px)`})},[nt.value?(t.openBlock(),t.createElementBlock("div",{key:0,class:"page-container fixed",style:t.normalizeStyle({width:x.value+"px",height:N.value+"px",left:V.value+"px",top:R.value+"px",position:"absolute"})},[t.createElementVNode("img",{class:"page-image",style:{width:"100%",height:"100%"},src:t.unref(fe)(G.value,!0),onLoad:p[0]||(p[0]=(...g)=>t.unref(le)&&t.unref(le)(...g))},null,40,ro),t.createElementVNode("div",{class:"page-hotspots",style:t.normalizeStyle({opacity:1-f.opacity,pointerEvents:f.opacity>.1?"none":"auto",zIndex:f.opacity>.1?1:10})},[t.renderSlot(l.$slots,"hotspot",{hotspots:st.value,page:G.value})],4)],4)):t.createCommentVNode("",!0),rt.value?(t.openBlock(),t.createElementBlock("div",{key:1,class:"page-container fixed",style:t.normalizeStyle({width:x.value+"px",height:N.value+"px",left:i.value/2+"px",top:R.value+"px",position:"absolute"})},[t.createElementVNode("img",{class:"page-image",style:{width:"100%",height:"100%"},src:t.unref(fe)(J.value,!0),onLoad:p[1]||(p[1]=(...g)=>t.unref(le)&&t.unref(le)(...g))},null,40,so),t.createElementVNode("div",{class:"page-hotspots",style:t.normalizeStyle({opacity:1-f.opacity,pointerEvents:f.opacity>.1?"none":"auto",zIndex:f.opacity>.1?1:10})},[t.renderSlot(l.$slots,"hotspot",{hotspots:it.value,page:J.value})],4)],4)):t.createCommentVNode("",!0),t.createElementVNode("div",{style:t.normalizeStyle({opacity:f.opacity})},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(ft.value,([g,y,D,P,z,ie])=>(t.openBlock(),t.createElementBlock("div",{key:g,class:t.normalizeClass(["polygon",{blank:!y}]),"data-img":y,style:t.normalizeStyle({backgroundImage:y&&`url(${t.unref(tt)(y)})`,backgroundSize:pt.value,backgroundPosition:P,width:ut.value,height:ct.value,transform:z,zIndex:ie})},[t.withDirectives(t.createElementVNode("div",{class:"lighting",style:t.normalizeStyle({backgroundImage:D})},null,4),[[t.vShow,D.length]])],14,io))),128))],4),t.createElementVNode("div",{class:"bounding-box",style:t.normalizeStyle({left:B.value+"px",top:R.value+"px",width:K.value-B.value+"px",height:N.value+"px",cursor:Ne.value}),onTouchstart:_t,onPointerdown:It,onMousedown:Pt},null,36)],4)],4)],38)]))}});pe.install=n=>(n.component(pe.name,pe),n);exports.default=pe;
//# sourceMappingURL=vue3-flipbook.js.map
